<!DOCTYPE html>
<!-- saved from url=(0019)file:///tmp/14.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style>@font-face {
  font-family: octicons-anchor;
  src: url(data:font/woff;charset=utf-8;base64,d09GRgABAAAAAAYcAA0AAAAACjQAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABGRlRNAAABMAAAABwAAAAca8vGTk9TLzIAAAFMAAAARAAAAFZG1VHVY21hcAAAAZAAAAA+AAABQgAP9AdjdnQgAAAB0AAAAAQAAAAEACICiGdhc3AAAAHUAAAACAAAAAj//wADZ2x5ZgAAAdwAAADRAAABEKyikaNoZWFkAAACsAAAAC0AAAA2AtXoA2hoZWEAAALgAAAAHAAAACQHngNFaG10eAAAAvwAAAAQAAAAEAwAACJsb2NhAAADDAAAAAoAAAAKALIAVG1heHAAAAMYAAAAHwAAACABEAB2bmFtZQAAAzgAAALBAAAFu3I9x/Nwb3N0AAAF/AAAAB0AAAAvaoFvbwAAAAEAAAAAzBdyYwAAAADP2IQvAAAAAM/bz7t4nGNgZGFgnMDAysDB1Ml0hoGBoR9CM75mMGLkYGBgYmBlZsAKAtJcUxgcPsR8iGF2+O/AEMPsznAYKMwIkgMA5REMOXicY2BgYGaAYBkGRgYQsAHyGMF8FgYFIM0ChED+h5j//yEk/3KoSgZGNgYYk4GRCUgwMaACRoZhDwCs7QgGAAAAIgKIAAAAAf//AAJ4nHWMMQrCQBBF/0zWrCCIKUQsTDCL2EXMohYGSSmorScInsRGL2DOYJe0Ntp7BK+gJ1BxF1stZvjz/v8DRghQzEc4kIgKwiAppcA9LtzKLSkdNhKFY3HF4lK69ExKslx7Xa+vPRVS43G98vG1DnkDMIBUgFN0MDXflU8tbaZOUkXUH0+U27RoRpOIyCKjbMCVejwypzJJG4jIwb43rfl6wbwanocrJm9XFYfskuVC5K/TPyczNU7b84CXcbxks1Un6H6tLH9vf2LRnn8Ax7A5WQAAAHicY2BkYGAA4teL1+yI57f5ysDNwgAC529f0kOmWRiYVgEpDgYmEA8AUzEKsQAAAHicY2BkYGB2+O/AEMPCAAJAkpEBFbAAADgKAe0EAAAiAAAAAAQAAAAEAAAAAAAAKgAqACoAiAAAeJxjYGRgYGBhsGFgYgABEMkFhAwM/xn0QAIAD6YBhwB4nI1Ty07cMBS9QwKlQapQW3VXySvEqDCZGbGaHULiIQ1FKgjWMxknMfLEke2A+IJu+wntrt/QbVf9gG75jK577Lg8K1qQPCfnnnt8fX1NRC/pmjrk/zprC+8D7tBy9DHgBXoWfQ44Av8t4Bj4Z8CLtBL9CniJluPXASf0Lm4CXqFX8Q84dOLnMB17N4c7tBo1AS/Qi+hTwBH4rwHHwN8DXqQ30XXAS7QaLwSc0Gn8NuAVWou/gFmnjLrEaEh9GmDdDGgL3B4JsrRPDU2hTOiMSuJUIdKQQayiAth69r6akSSFqIJuA19TrzCIaY8sIoxyrNIrL//pw7A2iMygkX5vDj+G+kuoLdX4GlGK/8Lnlz6/h9MpmoO9rafrz7ILXEHHaAx95s9lsI7AHNMBWEZHULnfAXwG9/ZqdzLI08iuwRloXE8kfhXYAvE23+23DU3t626rbs8/8adv+9DWknsHp3E17oCf+Z48rvEQNZ78paYM38qfk3v/u3l3u3GXN2Dmvmvpf1Srwk3pB/VSsp512bA/GG5i2WJ7wu430yQ5K3nFGiOqgtmSB5pJVSizwaacmUZzZhXLlZTq8qGGFY2YcSkqbth6aW1tRmlaCFs2016m5qn36SbJrqosG4uMV4aP2PHBmB3tjtmgN2izkGQyLWprekbIntJFing32a5rKWCN/SdSoga45EJykyQ7asZvHQ8PTm6cslIpwyeyjbVltNikc2HTR7YKh9LBl9DADC0U/jLcBZDKrMhUBfQBvXRzLtFtjU9eNHKin0x5InTqb8lNpfKv1s1xHzTXRqgKzek/mb7nB8RZTCDhGEX3kK/8Q75AmUM/eLkfA+0Hi908Kx4eNsMgudg5GLdRD7a84npi+YxNr5i5KIbW5izXas7cHXIMAau1OueZhfj+cOcP3P8MNIWLyYOBuxL6DRylJ4cAAAB4nGNgYoAALjDJyIAOWMCiTIxMLDmZedkABtIBygAAAA==) format('woff');
}

* {
    box-sizing: border-box;
}

body {
    width: 980px;
    margin-right: auto;
    margin-left: auto;
}

body .markdown-body {
    padding: 45px;
    border: 1px solid #ddd;
    border-radius: 3px;
    word-wrap: break-word;
}

pre {
    font: 12px Consolas, "Liberation Mono", Menlo, Courier, monospace;
}

.markdown-body {
  -webkit-text-size-adjust: 100%;
  text-size-adjust: 100%;
  color: #333;
  font-family: "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
  font-size: 16px;
  line-height: 1.6;
  word-wrap: break-word;
}

.markdown-body a {
  background-color: transparent;
}

.markdown-body a:active,
.markdown-body a:hover {
  outline: 0;
}

.markdown-body strong {
  font-weight: bold;
}

.markdown-body h1 {
  font-size: 2em;
  margin: 0.67em 0;
}

.markdown-body img {
  border: 0;
}

.markdown-body hr {
  box-sizing: content-box;
  height: 0;
}

.markdown-body pre {
  overflow: auto;
}

.markdown-body code,
.markdown-body kbd,
.markdown-body pre {
  font-family: monospace, monospace;
  font-size: 1em;
}

.markdown-body input {
  color: inherit;
  font: inherit;
  margin: 0;
}

.markdown-body html input[disabled] {
  cursor: default;
}

.markdown-body input {
  line-height: normal;
}

.markdown-body input[type="checkbox"] {
  box-sizing: border-box;
  padding: 0;
}

.markdown-body table {
  border-collapse: collapse;
  border-spacing: 0;
}

.markdown-body td,
.markdown-body th {
  padding: 0;
}

.markdown-body input {
  font: 13px / 1.4 Helvetica, arial, nimbussansl, liberationsans, freesans, clean, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
}

.markdown-body a {
  color: #4078c0;
  text-decoration: none;
}

.markdown-body a:hover,
.markdown-body a:active {
  text-decoration: underline;
}

.markdown-body hr {
  height: 0;
  margin: 15px 0;
  overflow: hidden;
  background: transparent;
  border: 0;
  border-bottom: 1px solid #ddd;
}

.markdown-body hr:before {
  display: table;
  content: "";
}

.markdown-body hr:after {
  display: table;
  clear: both;
  content: "";
}

.markdown-body h1,
.markdown-body h2,
.markdown-body h3,
.markdown-body h4,
.markdown-body h5,
.markdown-body h6 {
  margin-top: 15px;
  margin-bottom: 15px;
  line-height: 1.1;
}

.markdown-body h1 {
  font-size: 30px;
}

.markdown-body h2 {
  font-size: 21px;
}

.markdown-body h3 {
  font-size: 16px;
}

.markdown-body h4 {
  font-size: 14px;
}

.markdown-body h5 {
  font-size: 12px;
}

.markdown-body h6 {
  font-size: 11px;
}

.markdown-body blockquote {
  margin: 0;
}

.markdown-body ul,
.markdown-body ol {
  padding: 0;
  margin-top: 0;
  margin-bottom: 0;
}

.markdown-body ol ol,
.markdown-body ul ol {
  list-style-type: lower-roman;
}

.markdown-body ul ul ol,
.markdown-body ul ol ol,
.markdown-body ol ul ol,
.markdown-body ol ol ol {
  list-style-type: lower-alpha;
}

.markdown-body dd {
  margin-left: 0;
}

.markdown-body code {
  font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
  font-size: 12px;
}

.markdown-body pre {
  margin-top: 0;
  margin-bottom: 0;
  font: 12px Consolas, "Liberation Mono", Menlo, Courier, monospace;
}

.markdown-body .select::-ms-expand {
  opacity: 0;
}

.markdown-body .octicon {
  font: normal normal normal 16px/1 octicons-anchor;
  display: inline-block;
  text-decoration: none;
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.markdown-body .octicon-link:before {
  content: '\f05c';
}

.markdown-body:before {
  display: table;
  content: "";
}

.markdown-body:after {
  display: table;
  clear: both;
  content: "";
}

.markdown-body>*:first-child {
  margin-top: 0 !important;
}

.markdown-body>*:last-child {
  margin-bottom: 0 !important;
}

.markdown-body a:not([href]) {
  color: inherit;
  text-decoration: none;
}

.markdown-body .anchor {
  display: inline-block;
  padding-right: 2px;
  margin-left: -18px;
}

.markdown-body .anchor:focus {
  outline: none;
}

.markdown-body h1,
.markdown-body h2,
.markdown-body h3,
.markdown-body h4,
.markdown-body h5,
.markdown-body h6 {
  margin-top: 1em;
  margin-bottom: 16px;
  font-weight: bold;
  line-height: 1.4;
}

.markdown-body h1 .octicon-link,
.markdown-body h2 .octicon-link,
.markdown-body h3 .octicon-link,
.markdown-body h4 .octicon-link,
.markdown-body h5 .octicon-link,
.markdown-body h6 .octicon-link {
  color: #000;
  vertical-align: middle;
  visibility: hidden;
}

.markdown-body h1:hover .anchor,
.markdown-body h2:hover .anchor,
.markdown-body h3:hover .anchor,
.markdown-body h4:hover .anchor,
.markdown-body h5:hover .anchor,
.markdown-body h6:hover .anchor {
  text-decoration: none;
}

.markdown-body h1:hover .anchor .octicon-link,
.markdown-body h2:hover .anchor .octicon-link,
.markdown-body h3:hover .anchor .octicon-link,
.markdown-body h4:hover .anchor .octicon-link,
.markdown-body h5:hover .anchor .octicon-link,
.markdown-body h6:hover .anchor .octicon-link {
  visibility: visible;
}

.markdown-body h1 {
  padding-bottom: 0.3em;
  font-size: 2.25em;
  line-height: 1.2;
  border-bottom: 1px solid #eee;
}

.markdown-body h1 .anchor {
  line-height: 1;
}

.markdown-body h2 {
  padding-bottom: 0.3em;
  font-size: 1.75em;
  line-height: 1.225;
  border-bottom: 1px solid #eee;
}

.markdown-body h2 .anchor {
  line-height: 1;
}

.markdown-body h3 {
  font-size: 1.5em;
  line-height: 1.43;
}

.markdown-body h3 .anchor {
  line-height: 1.2;
}

.markdown-body h4 {
  font-size: 1.25em;
}

.markdown-body h4 .anchor {
  line-height: 1.2;
}

.markdown-body h5 {
  font-size: 1em;
}

.markdown-body h5 .anchor {
  line-height: 1.1;
}

.markdown-body h6 {
  font-size: 1em;
  color: #777;
}

.markdown-body h6 .anchor {
  line-height: 1.1;
}

.markdown-body p,
.markdown-body blockquote,
.markdown-body ul,
.markdown-body ol,
.markdown-body dl,
.markdown-body table,
.markdown-body pre {
  margin-top: 0;
  margin-bottom: 16px;
}

.markdown-body hr {
  height: 4px;
  padding: 0;
  margin: 16px 0;
  background-color: #e7e7e7;
  border: 0 none;
}

.markdown-body ul,
.markdown-body ol {
  padding-left: 2em;
}

.markdown-body ul ul,
.markdown-body ul ol,
.markdown-body ol ol,
.markdown-body ol ul {
  margin-top: 0;
  margin-bottom: 0;
}

.markdown-body li>p {
  margin-top: 16px;
}

.markdown-body dl {
  padding: 0;
}

.markdown-body dl dt {
  padding: 0;
  margin-top: 16px;
  font-size: 1em;
  font-style: italic;
  font-weight: bold;
}

.markdown-body dl dd {
  padding: 0 16px;
  margin-bottom: 16px;
}

.markdown-body blockquote {
  padding: 0 15px;
  color: #777;
  border-left: 4px solid #ddd;
}

.markdown-body blockquote>:first-child {
  margin-top: 0;
}

.markdown-body blockquote>:last-child {
  margin-bottom: 0;
}

.markdown-body table {
  display: block;
  width: 100%;
  overflow: auto;
  word-break: normal;
  word-break: keep-all;
}

.markdown-body table th {
  font-weight: bold;
}

.markdown-body table th,
.markdown-body table td {
  padding: 6px 13px;
  border: 1px solid #ddd;
}

.markdown-body table tr {
  background-color: #fff;
  border-top: 1px solid #ccc;
}

.markdown-body table tr:nth-child(2n) {
  background-color: #f8f8f8;
}

.markdown-body img {
  max-width: 100%;
  box-sizing: content-box;
  background-color: #fff;
}

.markdown-body code {
  padding: 0;
  padding-top: 0.2em;
  padding-bottom: 0.2em;
  margin: 0;
  font-size: 85%;
  background-color: rgba(0,0,0,0.04);
  border-radius: 3px;
}

.markdown-body code:before,
.markdown-body code:after {
  letter-spacing: -0.2em;
  content: "\00a0";
}

.markdown-body pre>code {
  padding: 0;
  margin: 0;
  font-size: 100%;
  word-break: normal;
  white-space: pre;
  background: transparent;
  border: 0;
}

.markdown-body .highlight {
  margin-bottom: 16px;
}

.markdown-body .highlight pre,
.markdown-body pre {
  padding: 16px;
  overflow: auto;
  font-size: 85%;
  line-height: 1.45;
  background-color: #f7f7f7;
  border-radius: 3px;
}

.markdown-body .highlight pre {
  margin-bottom: 0;
  word-break: normal;
}

.markdown-body pre {
  word-wrap: normal;
}

.markdown-body pre code {
  display: inline;
  max-width: initial;
  padding: 0;
  margin: 0;
  overflow: initial;
  line-height: inherit;
  word-wrap: normal;
  background-color: transparent;
  border: 0;
}

.markdown-body pre code:before,
.markdown-body pre code:after {
  content: normal;
}

.markdown-body kbd {
  display: inline-block;
  padding: 3px 5px;
  font-size: 11px;
  line-height: 10px;
  color: #555;
  vertical-align: middle;
  background-color: #fcfcfc;
  border: solid 1px #ccc;
  border-bottom-color: #bbb;
  border-radius: 3px;
  box-shadow: inset 0 -1px 0 #bbb;
}

.markdown-body .pl-c {
  color: #969896;
}

.markdown-body .pl-c1,
.markdown-body .pl-s .pl-v {
  color: #0086b3;
}

.markdown-body .pl-e,
.markdown-body .pl-en {
  color: #795da3;
}

.markdown-body .pl-s .pl-s1,
.markdown-body .pl-smi {
  color: #333;
}

.markdown-body .pl-ent {
  color: #63a35c;
}

.markdown-body .pl-k {
  color: #a71d5d;
}

.markdown-body .pl-pds,
.markdown-body .pl-s,
.markdown-body .pl-s .pl-pse .pl-s1,
.markdown-body .pl-sr,
.markdown-body .pl-sr .pl-cce,
.markdown-body .pl-sr .pl-sra,
.markdown-body .pl-sr .pl-sre {
  color: #183691;
}

.markdown-body .pl-v {
  color: #ed6a43;
}

.markdown-body .pl-id {
  color: #b52a1d;
}

.markdown-body .pl-ii {
  background-color: #b52a1d;
  color: #f8f8f8;
}

.markdown-body .pl-sr .pl-cce {
  color: #63a35c;
  font-weight: bold;
}

.markdown-body .pl-ml {
  color: #693a17;
}

.markdown-body .pl-mh,
.markdown-body .pl-mh .pl-en,
.markdown-body .pl-ms {
  color: #1d3e81;
  font-weight: bold;
}

.markdown-body .pl-mq {
  color: #008080;
}

.markdown-body .pl-mi {
  color: #333;
  font-style: italic;
}

.markdown-body .pl-mb {
  color: #333;
  font-weight: bold;
}

.markdown-body .pl-md {
  background-color: #ffecec;
  color: #bd2c00;
}

.markdown-body .pl-mi1 {
  background-color: #eaffea;
  color: #55a532;
}

.markdown-body .pl-mdr {
  color: #795da3;
  font-weight: bold;
}

.markdown-body .pl-mo {
  color: #1d3e81;
}

.markdown-body kbd {
  display: inline-block;
  padding: 3px 5px;
  font: 11px Consolas, "Liberation Mono", Menlo, Courier, monospace;
  line-height: 10px;
  color: #555;
  vertical-align: middle;
  background-color: #fcfcfc;
  border: solid 1px #ccc;
  border-bottom-color: #bbb;
  border-radius: 3px;
  box-shadow: inset 0 -1px 0 #bbb;
}

.markdown-body .plan-price-unit {
  color: #767676;
  font-weight: normal;
}

.markdown-body .task-list-item {
  list-style-type: none;
}

.markdown-body .task-list-item+.task-list-item {
  margin-top: 3px;
}

.markdown-body .task-list-item input {
  margin: 0 0.35em 0.25em -1.6em;
  vertical-align: middle;
}

.markdown-body .plan-choice {
  padding: 15px;
  padding-left: 40px;
  display: block;
  border: 1px solid #e0e0e0;
  position: relative;
  font-weight: normal;
  background-color: #fafafa;
}

.markdown-body .plan-choice.open {
  background-color: #fff;
}

.markdown-body .plan-choice.open .plan-choice-seat-breakdown {
  display: block;
}

.markdown-body .plan-choice-free {
  border-radius: 3px 3px 0 0;
}

.markdown-body .plan-choice-paid {
  border-radius: 0 0 3px 3px;
  border-top: 0;
  margin-bottom: 20px;
}

.markdown-body .plan-choice-radio {
  position: absolute;
  left: 15px;
  top: 18px;
}

.markdown-body .plan-choice-exp {
  color: #999;
  font-size: 12px;
  margin-top: 5px;
}

.markdown-body .plan-choice-seat-breakdown {
  margin-top: 10px;
  display: none;
}

.markdown-body :checked+.radio-label {
  z-index: 1;
  position: relative;
  border-color: #4078c0;
}
</style><script type="text/javascript" src="./README_files/MathJax.js"></script>
<script>
MathJax.Hub.Config({
  config: ["MMLorHTML.js"],
  extensions: ["tex2jax.js"],
  jax: ["input/TeX"],
  tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"] ],
    displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
    processEscapes: false
  },
  TeX: {
    extensions: ["AMSmath.js", "AMSsymbols.js"],
    TagSide: "right",
    TagIndent: ".8em",
    MultLineWidth: "85%",
    equationNumbers: {
      autoNumber: "AMS",
    },
    unicode: {
      fonts: "STIXGeneral,'Arial Unicode MS'"
    }
  },
  showProcessingMessages: false
});
</script>
<title>README</title><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax_LineBox {display: table!important}
.MathJax_LineBox span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Blank; src: url('about:blank')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head><body><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div><article class="markdown-body"><h1>
<a id="user-content-introduction" class="anchor" href="file:///tmp/14.html#introduction" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Introduction</h1>
<p>2D-GP is a FORTRAN project designed to numerically solve the Gross-Pitaevskii equation (GPE) in two dimensions (2D). Solving the GPE allows for qualitatively accurate simulations of Bose-Einstein Condensates (BECs) at zero temperature.<br>
2D-GP solves the GPE using 4th order Runge-Kutta time stepping on a grid of points with regular spacing in both the x and y dimensions. User defined grid spacing and time step is supported.</p>
<h3>
<a id="user-content-requirements" class="anchor" href="file:///tmp/14.html#requirements" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Requirements</h3>
<p>2D-GP requires NetCDF and NetCDF-Fortran installations to run. NetCDF is used to save compressed data files. On Ubuntu you can install the required packages by running:</p>
<pre><code>sudo apt-get install libnetcdf11 libnetcdff6 libnetcdf-dev libnetcdff-dev
</code></pre>
<p>You can also create a local installation of NetCDF by downloading the source files from the <a href="https://www.unidata.ucar.edu/software/netcdf/" rel="nofollow">NetCDF website</a> and compiling them yourself. If you do this, make a note of the installation location as you will need it to install 2D-GP.</p>
<h3>
<a id="user-content-installation" class="anchor" href="file:///tmp/14.html#installation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Installation</h3>
<ul>
<li>
<p>Clone the git repository somewhere : <code>git clone https://github.com/Extigy/2D-GP.git</code></p>
</li>
<li>
<p>Run <code>./install</code> to setup. You can also run  <code>./install &lt;install-dir&gt;</code> to install to any desired installation location.</p>
</li>
<li>
<p>If you have a non-system installation of NetCDF (i.e. you compiled it from source), edit the file <code>Makefile</code> and at the top change the <code>NETCDF</code> and <code>NETCDF-FORTRAN</code> variables to match your installation directory.</p>
</li>
<li>
<p>New terminals should now be able to run  <code>make2dgp</code> anywhere.</p>
</li>
</ul>
<h3>
<a id="user-content-running-a-simulation" class="anchor" href="file:///tmp/14.html#running-a-simulation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Running a Simulation</h3>
<ul>
<li>Create a new simulation directory</li>
<li>Enter the directory and run <code>make2dgp</code> to set up a simulation at your current location.</li>
<li>Type <code>./gp&amp;</code> to start the simulation.</li>
<li>The simulation status is printed to the file <code>STATUS</code>.</li>
</ul>
<h3>
<a id="user-content-editing-parameters" class="anchor" href="file:///tmp/14.html#editing-parameters" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Editing Parameters</h3>
<p>To run a simulation with custom parameters</p>
<ul>
<li>Create a simulation as in <strong>Running a Simulation</strong> but do not run <code>./gp&amp;</code>.</li>
<li>Edit <code>params.in</code> to include any parameters you wish to change from their defaults and run <code>make2dgp</code> again to reflect the changes.</li>
<li>Run <code>./gp&amp;</code> to start the simulation.</li>
</ul>
<p>A full list of parameters, their descriptions, and their default values is included at the end. The code is written so that, most editable parameters can be left as default and so not included in <code>params.in</code> at all.</p>
<h1>
<a id="user-content-gross-pitaevskii-equation" class="anchor" href="file:///tmp/14.html#gross-pitaevskii-equation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Gross-Pitaevskii Equation</h1>
<p>2D-GP solves the GPE in 2 different dimensionless forms: the homogeneous system and the harmonically trapped system.</p>
<p>The homogeneous system is primarily used to emulate superfluid helium II. The harmonic trapped case is primarily used to emulate quasi-2D BEC experiments, confined using a harmonic trap.</p>
<h3>
<a id="user-content-homogeneous-system" class="anchor" href="file:///tmp/14.html#homogeneous-system" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Homogeneous System</h3>
<p>The dimensionless homogeneous GPE is defined as
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;&amp;#x03C8;&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;msup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mi&gt;&amp;#x03C8;&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03C8;&lt;/mi&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mi&gt;&amp;#x03C8;&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mi&gt;&amp;#x03C8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03C8;&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;&amp;#x03C8;&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 22.833em; display: inline-block;"><span style="display: inline-block; position: relative; width: 18.856em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.984em 1018.8em 3.308em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: STIXGeneral; font-style: italic;">i</span><span class="mfrac" id="MathJax-Span-4"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(3.153em 1001.14em 4.341em -999.997em); top: -4.646em; left: 50%; margin-left: -0.566em;"><span class="mrow" id="MathJax-Span-5"><span class="mi" id="MathJax-Span-6" style="font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-7" style="font-family: STIXGeneral; font-style: italic;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.153em 1000.78em 4.135em -999.997em); top: -3.303em; left: 50%; margin-left: -0.359em;"><span class="mrow" id="MathJax-Span-8"><span class="mi" id="MathJax-Span-9" style="font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-10" style="font-family: STIXGeneral; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(0.881em 1001.24em 1.242em -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.242em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span><span class="mo" id="MathJax-Span-11" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mo" id="MathJax-Span-12" style="font-family: STIXGeneral; padding-left: 0.313em;">−</span><span class="mfrac" id="MathJax-Span-13"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(3.153em 1000.42em 4.135em -999.997em); top: -4.646em; left: 50%; margin-left: -0.256em;"><span class="mn" id="MathJax-Span-14" style="font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.153em 1000.47em 4.135em -999.997em); top: -3.303em; left: 50%; margin-left: -0.256em;"><span class="mn" id="MathJax-Span-15" style="font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(0.881em 1000.62em 1.242em -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.622em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-16"><span style="display: inline-block; position: relative; width: 1.139em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.67em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-17" style="font-family: STIXGeneral;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.388em; left: 0.726em;"><span class="mn" id="MathJax-Span-18" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mi" id="MathJax-Span-19" style="font-family: STIXGeneral; font-style: italic;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-20" style="font-family: STIXGeneral; padding-left: 0.261em;">+</span><span class="texatom" id="MathJax-Span-21" style="padding-left: 0.261em;"><span class="mrow" id="MathJax-Span-22"><span class="mo" id="MathJax-Span-23" style="font-family: STIXVariants;">|</span></span></span><span class="mi" id="MathJax-Span-24" style="font-family: STIXGeneral; font-style: italic;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="msubsup" id="MathJax-Span-25"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.21em 4.341em -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-26"><span class="mrow" id="MathJax-Span-27"><span class="mo" id="MathJax-Span-28" style="font-family: STIXVariants;">|</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.388em; left: 0.313em;"><span class="mn" id="MathJax-Span-29" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mi" id="MathJax-Span-30" style="font-family: STIXGeneral; font-style: italic;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-31" style="font-family: STIXGeneral; padding-left: 0.261em;">+</span><span class="mi" id="MathJax-Span-32" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.261em;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mi" id="MathJax-Span-33" style="font-family: STIXGeneral; font-style: italic;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-34" style="font-family: STIXGeneral; padding-left: 0.261em;">−</span><span class="mi" id="MathJax-Span-35" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.261em;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-36" style="font-family: STIXGeneral; padding-left: 0.261em;">+</span><span class="mi" id="MathJax-Span-37" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.261em;">i</span><span class="msubsup" id="MathJax-Span-38"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.36em 1000.42em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-39" style="font-family: STIXGeneral; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="texatom" id="MathJax-Span-40"><span class="mrow" id="MathJax-Span-41"><span class="mi" id="MathJax-Span-42" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">o</span><span class="mi" id="MathJax-Span-43" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">b</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mfrac" id="MathJax-Span-44"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(3.153em 1001.14em 4.341em -999.997em); top: -4.646em; left: 50%; margin-left: -0.566em;"><span class="mrow" id="MathJax-Span-45"><span class="mi" id="MathJax-Span-46" style="font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-47" style="font-family: STIXGeneral; font-style: italic;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.153em 1000.93em 4.135em -999.997em); top: -3.303em; left: 50%; margin-left: -0.462em;"><span class="mrow" id="MathJax-Span-48"><span class="mi" id="MathJax-Span-49" style="font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-50" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(0.881em 1001.24em 1.242em -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.242em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span><span class="mo" id="MathJax-Span-51" style="font-family: STIXGeneral;">,</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.872em; border-left: 0px solid; width: 0px; height: 2.628em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>i</mi><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>ψ</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msup><mi mathvariant="normal">∇</mi><mn>2</mn></msup><mi>ψ</mi><mo>+</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>ψ</mi><msup><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mn>2</mn></msup><mi>ψ</mi><mo>+</mo><mi>V</mi><mi>ψ</mi><mo>−</mo><mi>ψ</mi><mo>+</mo><mi>i</mi><msub><mi>v</mi><mrow class="MJX-TeXAtom-ORD"><mi>o</mi><mi>b</mi></mrow></msub><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>ψ</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac><mo>,</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-1">i\frac{\partial\psi}{\partial t}=-\frac{1}{2}\nabla^2\psi+|\psi|^2\psi+V\psi-\psi+iv_{ob}\frac{\partial\psi}{\partial x},</script>
where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C8;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-52" style="width: 0.829em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.862em 1000.67em 2.843em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-53"><span class="mi" id="MathJax-Span-54" style="font-family: STIXGeneral; font-style: italic;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ψ</mi></math></span></span><script type="math/tex" id="MathJax-Element-2">\psi</script> is the wavefunction, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-55" style="width: 0.829em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.655em 1000.67em 2.637em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-56"><span class="mi" id="MathJax-Span-57" style="font-family: STIXGeneral; font-style: italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>V</mi></math></span></span><script type="math/tex" id="MathJax-Element-3">V</script> is a potential allowing for the use of boundaries and obstacles and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-58" style="width: 1.501em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.552em 1001.24em 2.482em -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-59"><span class="msubsup" id="MathJax-Span-60"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.36em 1000.42em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-61" style="font-family: STIXGeneral; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="texatom" id="MathJax-Span-62"><span class="mrow" id="MathJax-Span-63"><span class="mi" id="MathJax-Span-64" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">o</span><span class="mi" id="MathJax-Span-65" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">b</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>v</mi><mrow class="MJX-TeXAtom-ORD"><mi>o</mi><mi>b</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-4">v_{ob}</script> is the fluid velocity along the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-66" style="width: 0.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.862em 1000.47em 2.637em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-67"><span class="mi" id="MathJax-Span-68" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-5">x</script> direction.</p>
<p>In this setup the wavefunction is scaled so that the density away from any perturbations is <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-69" style="width: 3.308em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.74em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.655em 1002.64em 2.792em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-70"><span class="msubsup" id="MathJax-Span-71"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.36em 1000.47em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-72" style="font-family: STIXGeneral; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mn" id="MathJax-Span-73" style="font-size: 70.7%; font-family: STIXGeneral;">0</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-74" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mn" id="MathJax-Span-75" style="font-family: STIXGeneral; padding-left: 0.313em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>n</mi><mn>0</mn></msub><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-6">n_0=1</script>.</p>
<p>This version of the GPE is valid when properties are scaled with the so called '<strong>natural units</strong>',</p>
<ul>
<li>Density at infinity: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-76" style="width: 1.139em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.552em 1000.93em 2.482em -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-77"><span class="msubsup" id="MathJax-Span-78"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.36em 1000.47em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-79" style="font-family: STIXGeneral; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mn" id="MathJax-Span-80" style="font-size: 70.7%; font-family: STIXGeneral;">0</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>n</mi><mn>0</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-7">n_0</script>,</li>
<li>Length: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03BE;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;mi class=&quot;MJX-variant&quot;&gt;&amp;#x210F;&lt;/mi&gt;&lt;msqrt&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;&amp;#x03BC;&lt;/mi&gt;&lt;/msqrt&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-81" style="width: 4.961em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.083em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.984em 1004.08em 3.67em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-82"><span class="mi" id="MathJax-Span-83" style="font-family: STIXGeneral; font-style: italic;">ξ</span><span class="mo" id="MathJax-Span-84" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mstyle" id="MathJax-Span-85" style="padding-left: 0.313em;"><span class="mrow" id="MathJax-Span-86"><span class="mfrac" id="MathJax-Span-87"><span style="display: inline-block; position: relative; width: 2.12em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(3.153em 1000.57em 4.135em -999.997em); top: -4.646em; left: 50%; margin-left: -0.307em;"><span class="mi" id="MathJax-Span-88" style="font-family: STIXVariants;">ℏ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.205em 1002.02em 4.496em -999.997em); top: -3.303em; left: 50%; margin-left: -0.979em;"><span class="msqrt" id="MathJax-Span-89"><span style="display: inline-block; position: relative; width: 2.017em; height: 0px;"><span style="position: absolute; clip: rect(3.36em 1001.19em 4.341em -999.997em); top: -3.975em; left: 0.726em;"><span class="mrow" id="MathJax-Span-90"><span class="mi" id="MathJax-Span-91" style="font-family: STIXGeneral; font-style: italic;">m</span><span class="mi" id="MathJax-Span-92" style="font-family: STIXGeneral; font-style: italic;">μ</span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(2.998em 1001.29em 3.36em -999.997em); top: -3.768em; left: 0.726em;"><span style="display: inline-block; position: relative; width: 1.294em; height: 0px;"><span style="position: absolute; font-family: STIXGeneral; top: -3.975em; left: 0em;">‾<span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; font-family: STIXGeneral; top: -3.975em; left: 0.777em;">‾<span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.975em; left: 0.364em;">‾<span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(2.895em 1000.78em 4.135em -999.997em); top: -3.613em; left: 0em;"><span style="font-family: STIXVariants;">√</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(0.881em 1002.12em 1.242em -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.12em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.309em; border-left: 0px solid; width: 0px; height: 3.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ξ</mi><mo>=</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mi class="MJX-variant">ℏ</mi><msqrt><mi>m</mi><mi>μ</mi></msqrt></mfrac></mstyle></math></span></span><script type="math/tex" id="MathJax-Element-8">\xi = \dfrac{\hbar}{\sqrt{m\mu}}</script>,</li>
<li>Energy: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-93" style="width: 3.98em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.257em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.862em 1003.21em 2.843em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-94"><span class="mi" id="MathJax-Span-95" style="font-family: STIXGeneral; font-style: italic;">μ</span><span class="mo" id="MathJax-Span-96" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-97" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.36em 1000.47em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-98" style="font-family: STIXGeneral; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mn" id="MathJax-Span-99" style="font-size: 70.7%; font-family: STIXGeneral;">0</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mi" id="MathJax-Span-100" style="font-family: STIXGeneral; font-style: italic;">g</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>μ</mi><mo>=</mo><msub><mi>n</mi><mn>0</mn></msub><mi>g</mi></math></span></span><script type="math/tex" id="MathJax-Element-9">\mu = n_0g</script>,</li>
<li>Velocity: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;msqrt&gt;&lt;msub&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/msqrt&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-101" style="width: 5.22em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.29em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.881em 1004.29em 3.308em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-102"><span class="mi" id="MathJax-Span-103" style="font-family: STIXGeneral; font-style: italic;">c</span><span class="mo" id="MathJax-Span-104" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mstyle" id="MathJax-Span-105" style="padding-left: 0.313em;"><span class="mrow" id="MathJax-Span-106"><span class="mfrac" id="MathJax-Span-107"><span style="display: inline-block; position: relative; width: 2.327em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(3.205em 1002.17em 4.496em -999.997em); top: -4.801em; left: 50%; margin-left: -1.082em;"><span class="msqrt" id="MathJax-Span-108"><span style="display: inline-block; position: relative; width: 2.172em; height: 0px;"><span style="position: absolute; clip: rect(3.36em 1001.4em 4.341em -999.997em); top: -3.975em; left: 0.726em;"><span class="mrow" id="MathJax-Span-109"><span class="msubsup" id="MathJax-Span-110"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.36em 1000.47em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-111" style="font-family: STIXGeneral; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="mn" id="MathJax-Span-112" style="font-size: 70.7%; font-family: STIXGeneral;">0</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mi" id="MathJax-Span-113" style="font-family: STIXGeneral; font-style: italic;">g</span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(2.998em 1001.45em 3.36em -999.997em); top: -3.768em; left: 0.726em;"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; font-family: STIXGeneral; top: -3.975em; left: 0em;">‾<span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; font-family: STIXGeneral; top: -3.975em; left: 0.932em;">‾<span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.975em; left: 0.313em;">‾<span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.975em; left: 0.622em;">‾<span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(2.895em 1000.78em 4.135em -999.997em); top: -3.613em; left: 0em;"><span style="font-family: STIXVariants;">√</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.36em 1000.73em 4.135em -999.997em); top: -3.303em; left: 50%; margin-left: -0.359em;"><span class="mi" id="MathJax-Span-114" style="font-family: STIXGeneral; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(0.881em 1002.33em 1.242em -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.327em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.872em; border-left: 0px solid; width: 0px; height: 2.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi><mo>=</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><msqrt><msub><mi>n</mi><mn>0</mn></msub><mi>g</mi></msqrt><mi>m</mi></mfrac></mstyle></math></span></span><script type="math/tex" id="MathJax-Element-10">c = \dfrac{\sqrt{n_0g}}{m}</script>,</li>
<li>Time: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;mi&gt;&amp;#x03BE;&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-115" style="width: 0.932em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.674em 1000.78em 2.998em -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-116"><span class="mstyle" id="MathJax-Span-117"><span class="mrow" id="MathJax-Span-118"><span class="mfrac" id="MathJax-Span-119"><span style="display: inline-block; position: relative; width: 0.571em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(3.153em 1000.47em 4.341em -999.997em); top: -4.646em; left: 50%; margin-left: -0.204em;"><span class="mi" id="MathJax-Span-120" style="font-family: STIXGeneral; font-style: italic;">ξ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.36em 1000.42em 4.135em -999.997em); top: -3.303em; left: 50%; margin-left: -0.204em;"><span class="mi" id="MathJax-Span-121" style="font-family: STIXGeneral; font-style: italic;">c</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(0.881em 1000.57em 1.242em -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.571em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.872em; border-left: 0px solid; width: 0px; height: 2.628em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mi>ξ</mi><mi>c</mi></mfrac></mstyle></math></span></span><script type="math/tex" id="MathJax-Element-11">\dfrac{\xi}{c}</script>.</li>
</ul>
<p>To use this system, set <code>RHSType=0</code> in <code>params.in</code>.</p>
<h3>
<a id="user-content-harmonically-trapped-system" class="anchor" href="file:///tmp/14.html#harmonically-trapped-system" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Harmonically Trapped System</h3>
<p>The dimensionless GPE in a harmonically trapped system is defined as
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;&amp;#x03C8;&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mfrac&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;msup&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mi&gt;&amp;#x03C8;&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03C8;&lt;/mi&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mi&gt;&amp;#x03C8;&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mi&gt;&amp;#x03C8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi&gt;&amp;#x03C8;&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi class=&quot;MJX-variant&quot;&gt;&amp;#x210F;&lt;/mi&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A9;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;&amp;#x03C8;&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;&amp;#x03C8;&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-122" style="width: 32.854em; display: inline-block;"><span style="display: inline-block; position: relative; width: 27.12em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(2.275em 1027.07em 4.806em -999.997em); top: -3.768em; left: 0em;"><span class="mrow" id="MathJax-Span-123"><span class="mi" id="MathJax-Span-124" style="font-family: STIXGeneral; font-style: italic;">i</span><span class="mfrac" id="MathJax-Span-125"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(3.153em 1001.14em 4.341em -999.997em); top: -4.646em; left: 50%; margin-left: -0.566em;"><span class="mrow" id="MathJax-Span-126"><span class="mi" id="MathJax-Span-127" style="font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-128" style="font-family: STIXGeneral; font-style: italic;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.153em 1000.78em 4.135em -999.997em); top: -3.303em; left: 50%; margin-left: -0.359em;"><span class="mrow" id="MathJax-Span-129"><span class="mi" id="MathJax-Span-130" style="font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-131" style="font-family: STIXGeneral; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(0.881em 1001.24em 1.242em -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.242em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span><span class="mo" id="MathJax-Span-132" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mo" id="MathJax-Span-133" style="font-family: STIXGeneral; padding-left: 0.313em;">−</span><span class="mfrac" id="MathJax-Span-134"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(3.153em 1000.42em 4.135em -999.997em); top: -4.646em; left: 50%; margin-left: -0.256em;"><span class="mn" id="MathJax-Span-135" style="font-family: STIXGeneral;">1</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.153em 1000.47em 4.135em -999.997em); top: -3.303em; left: 50%; margin-left: -0.256em;"><span class="mn" id="MathJax-Span-136" style="font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(0.881em 1000.62em 1.242em -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 0.622em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-137"><span style="display: inline-block; position: relative; width: 1.139em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.67em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-138" style="font-family: STIXGeneral;">∇</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.388em; left: 0.726em;"><span class="mn" id="MathJax-Span-139" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mi" id="MathJax-Span-140" style="font-family: STIXGeneral; font-style: italic;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-141" style="font-family: STIXGeneral; padding-left: 0.261em;">+</span><span class="msubsup" id="MathJax-Span-142" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; clip: rect(3.36em 1000.47em 4.341em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-143" style="font-family: STIXGeneral; font-style: italic;">g</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="texatom" id="MathJax-Span-144"><span class="mrow" id="MathJax-Span-145"><span class="mn" id="MathJax-Span-146" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span class="mi" id="MathJax-Span-147" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">D</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="texatom" id="MathJax-Span-148"><span class="mrow" id="MathJax-Span-149"><span class="mo" id="MathJax-Span-150" style="font-family: STIXVariants;">|</span></span></span><span class="mi" id="MathJax-Span-151" style="font-family: STIXGeneral; font-style: italic;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="msubsup" id="MathJax-Span-152"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.21em 4.341em -999.997em); top: -3.975em; left: 0em;"><span class="texatom" id="MathJax-Span-153"><span class="mrow" id="MathJax-Span-154"><span class="mo" id="MathJax-Span-155" style="font-family: STIXVariants;">|</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.388em; left: 0.313em;"><span class="mn" id="MathJax-Span-156" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mi" id="MathJax-Span-157" style="font-family: STIXGeneral; font-style: italic;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-158" style="font-family: STIXGeneral; padding-left: 0.261em;">+</span><span class="mi" id="MathJax-Span-159" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.261em;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mi" id="MathJax-Span-160" style="font-family: STIXGeneral; font-style: italic;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-161" style="font-family: STIXGeneral; padding-left: 0.261em;">−</span><span class="msubsup" id="MathJax-Span-162" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; clip: rect(3.412em 1000.47em 4.341em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-163" style="font-family: STIXGeneral; font-style: italic;">μ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="texatom" id="MathJax-Span-164"><span class="mrow" id="MathJax-Span-165"><span class="mn" id="MathJax-Span-166" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span class="mi" id="MathJax-Span-167" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">D</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mi" id="MathJax-Span-168" style="font-family: STIXGeneral; font-style: italic;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span><span class="mo" id="MathJax-Span-169" style="font-family: STIXGeneral; padding-left: 0.261em;">−</span><span class="mi" id="MathJax-Span-170" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.261em;">i</span><span class="mi" id="MathJax-Span-171" style="font-family: STIXVariants;">ℏ</span><span class="mi" id="MathJax-Span-172" style="font-family: STIXGeneral;">Ω</span><span class="mrow" id="MathJax-Span-173" style="padding-left: 0.209em;"><span class="mo" id="MathJax-Span-174" style="vertical-align: -0.462em;"><span><span style="font-size: 111%; font-family: STIXSizeTwoSym;">(</span></span></span><span class="mrow" id="MathJax-Span-175"><span class="mi" id="MathJax-Span-176" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mfrac" id="MathJax-Span-177"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(3.153em 1001.14em 4.341em -999.997em); top: -4.646em; left: 50%; margin-left: -0.566em;"><span class="mrow" id="MathJax-Span-178"><span class="mi" id="MathJax-Span-179" style="font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-180" style="font-family: STIXGeneral; font-style: italic;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.153em 1000.88em 4.341em -999.997em); top: -3.303em; left: 50%; margin-left: -0.462em;"><span class="mrow" id="MathJax-Span-181"><span class="mi" id="MathJax-Span-182" style="font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-183" style="font-family: STIXGeneral; font-style: italic;">y</span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(0.881em 1001.24em 1.242em -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.242em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span><span class="mo" id="MathJax-Span-184" style="font-family: STIXGeneral; padding-left: 0.261em;">−</span><span class="mi" id="MathJax-Span-185" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.261em;">y</span><span class="mfrac" id="MathJax-Span-186"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(3.153em 1001.14em 4.341em -999.997em); top: -4.646em; left: 50%; margin-left: -0.566em;"><span class="mrow" id="MathJax-Span-187"><span class="mi" id="MathJax-Span-188" style="font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-189" style="font-family: STIXGeneral; font-style: italic;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.153em 1000.93em 4.135em -999.997em); top: -3.303em; left: 50%; margin-left: -0.462em;"><span class="mrow" id="MathJax-Span-190"><span class="mi" id="MathJax-Span-191" style="font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-192" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(0.881em 1001.24em 1.242em -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.242em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-193" style="vertical-align: -0.462em;"><span><span style="font-size: 111%; font-family: STIXSizeTwoSym;">)</span></span></span></span><span class="mo" id="MathJax-Span-194" style="font-family: STIXGeneral; padding-left: 0.209em;">,</span></span><span style="display: inline-block; width: 0px; height: 3.773em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.122em; border-left: 0px solid; width: 0px; height: 2.816em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>i</mi><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>ψ</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msup><mi mathvariant="normal">∇</mi><mn>2</mn></msup><mi>ψ</mi><mo>+</mo><msub><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn><mi>D</mi></mrow></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>ψ</mi><msup><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mn>2</mn></msup><mi>ψ</mi><mo>+</mo><mi>V</mi><mi>ψ</mi><mo>−</mo><msub><mi>μ</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn><mi>D</mi></mrow></msub><mi>ψ</mi><mo>−</mo><mi>i</mi><mi class="MJX-variant">ℏ</mi><mi mathvariant="normal">Ω</mi><mrow><mo>(</mo><mrow><mi>x</mi><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>ψ</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>y</mi></mrow></mfrac><mo>−</mo><mi>y</mi><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>ψ</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>x</mi></mrow></mfrac></mrow><mo>)</mo></mrow><mo>,</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-12">i\frac{\partial\psi}{\partial t}=-\frac{1}{2}\nabla^2\psi+g_{2D}|\psi|^2\psi+V\psi-\mu_{2D}\psi - i \hbar\Omega\left(x\frac{\partial \psi}{\partial y}-y\frac{\partial \psi}{\partial x}\right),</script>
where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C8;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-195" style="width: 0.829em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.862em 1000.67em 2.843em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-196"><span class="mi" id="MathJax-Span-197" style="font-family: STIXGeneral; font-style: italic;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ψ</mi></math></span></span><script type="math/tex" id="MathJax-Element-13">\psi</script> is the condensate wavefunction, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-198" style="width: 1.759em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.552em 1001.45em 2.534em -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-199"><span class="msubsup" id="MathJax-Span-200"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; clip: rect(3.36em 1000.47em 4.341em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-201" style="font-family: STIXGeneral; font-style: italic;">g</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="texatom" id="MathJax-Span-202"><span class="mrow" id="MathJax-Span-203"><span class="mn" id="MathJax-Span-204" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span class="mi" id="MathJax-Span-205" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">D</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn><mi>D</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-14">g_{2D}</script> is the interaction strength, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-206" style="width: 0.829em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.655em 1000.67em 2.637em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-207"><span class="mi" id="MathJax-Span-208" style="font-family: STIXGeneral; font-style: italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>V</mi></math></span></span><script type="math/tex" id="MathJax-Element-15">V</script> is a potential allowing for the use of boundaries and obstacles, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-209" style="width: 1.759em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.604em 1001.45em 2.534em -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-210"><span class="msubsup" id="MathJax-Span-211"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; clip: rect(3.412em 1000.47em 4.341em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-212" style="font-family: STIXGeneral; font-style: italic;">μ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="texatom" id="MathJax-Span-213"><span class="mrow" id="MathJax-Span-214"><span class="mn" id="MathJax-Span-215" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span class="mi" id="MathJax-Span-216" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">D</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>μ</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn><mi>D</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-16">\mu_{2D}</script> is the chemical potential, and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A9;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-217" style="width: 0.881em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.655em 1000.67em 2.637em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-218"><span class="mi" id="MathJax-Span-219" style="font-family: STIXGeneral;">Ω</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Ω</mi></math></span></span><script type="math/tex" id="MathJax-Element-17">\Omega</script> is the angular momentum of the rotating frame.</p>
<p>This version of the GPE is valid when properties are scaled with the so called '<strong>harmonic oscillator units</strong>':</p>
<ul>
<li>Length: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msqrt&gt;&lt;mfrac&gt;&lt;mi class=&quot;MJX-variant&quot;&gt;&amp;#x210F;&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/msqrt&gt;&lt;/mstyle&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-220" style="width: 6.356em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.22em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.881em 1005.22em 3.618em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-221"><span class="mstyle" id="MathJax-Span-222"><span class="mrow" id="MathJax-Span-223"><span class="msubsup" id="MathJax-Span-224"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.26em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-225" style="font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.261em;"><span class="mi" id="MathJax-Span-226" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-227" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="msqrt" id="MathJax-Span-228" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 3.308em; height: 0px;"><span style="position: absolute; clip: rect(2.482em 1002.12em 4.961em -999.997em); top: -3.975em; left: 1.139em;"><span class="mrow" id="MathJax-Span-229"><span class="mfrac" id="MathJax-Span-230"><span style="display: inline-block; position: relative; width: 1.914em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(3.153em 1000.57em 4.135em -999.997em); top: -4.646em; left: 50%; margin-left: -0.307em;"><span class="mi" id="MathJax-Span-231" style="font-family: STIXVariants;">ℏ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.36em 1001.76em 4.29em -999.997em); top: -3.303em; left: 50%; margin-left: -0.876em;"><span class="mrow" id="MathJax-Span-232"><span class="mi" id="MathJax-Span-233" style="font-family: STIXGeneral; font-style: italic;">m</span><span class="msubsup" id="MathJax-Span-234"><span style="display: inline-block; position: relative; width: 1.036em; height: 0px;"><span style="position: absolute; clip: rect(3.412em 1000.67em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-235" style="font-family: STIXGeneral; font-style: italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.674em;"><span class="mi" id="MathJax-Span-236" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(0.881em 1001.91em 1.242em -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.914em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(2.998em 1002.17em 3.36em -999.997em); top: -4.595em; left: 1.139em;"><span style="display: inline-block; position: relative; width: 2.172em; height: 0px;"><span style="position: absolute; font-family: STIXGeneral; top: -3.975em; left: 0em;">‾<span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; font-family: STIXGeneral; top: -3.975em; left: 1.655em;">‾<span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.975em; left: 0.416em;">‾<span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.975em; left: 0.829em;">‾<span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.975em; left: 1.242em;">‾<span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(1.759em 1001.14em 4.548em -999.997em); top: -3.407em; left: 0em;"><span style="font-family: STIXSizeTwoSym;">√</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true" scriptlevel="0"><msub><mi>l</mi><mi>r</mi></msub><mo>=</mo><msqrt><mfrac><mi class="MJX-variant">ℏ</mi><mrow><mi>m</mi><msub><mi>ω</mi><mi>r</mi></msub></mrow></mfrac></msqrt></mstyle></math></span></span><script type="math/tex" id="MathJax-Element-18">\displaystyle l_r = \sqrt{\frac{\hbar}{m\omega_r}}</script>,</li>
<li>Energy: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi class=&quot;MJX-variant&quot;&gt;&amp;#x210F;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-237" style="width: 4.186em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.463em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.655em 1003.46em 2.843em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-238"><span class="mi" id="MathJax-Span-239" style="font-family: STIXGeneral; font-style: italic;">μ</span><span class="mo" id="MathJax-Span-240" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mi" id="MathJax-Span-241" style="font-family: STIXVariants; padding-left: 0.313em;">ℏ</span><span class="msubsup" id="MathJax-Span-242"><span style="display: inline-block; position: relative; width: 1.036em; height: 0px;"><span style="position: absolute; clip: rect(3.412em 1000.67em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-243" style="font-family: STIXGeneral; font-style: italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.674em;"><span class="mi" id="MathJax-Span-244" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>μ</mi><mo>=</mo><mi class="MJX-variant">ℏ</mi><msub><mi>ω</mi><mi>r</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-19">\mu = \hbar\omega_r</script>,</li>
<li>Time: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-245" style="width: 1.965em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.604em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.087em 1001.6em 2.482em -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-246"><span class="msubsup" id="MathJax-Span-247"><span style="display: inline-block; position: relative; width: 1.604em; height: 0px;"><span style="position: absolute; clip: rect(3.412em 1000.67em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-248" style="font-family: STIXGeneral; font-style: italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.36em 1000.93em 4.238em -999.997em); top: -4.44em; left: 0.674em;"><span class="texatom" id="MathJax-Span-249"><span class="mrow" id="MathJax-Span-250"><span class="mo" id="MathJax-Span-251" style="font-size: 70.7%; font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-252" style="font-size: 70.7%; font-family: STIXGeneral;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.515em 1000.36em 4.135em -999.997em); top: -3.82em; left: 0.674em;"><span class="mi" id="MathJax-Span-253" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>ω</mi><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-20">\omega_r^{-1}</script>,</li>
</ul>
<p>where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-254" style="width: 1.294em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.036em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.604em 1001.04em 2.482em -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-255"><span class="msubsup" id="MathJax-Span-256"><span style="display: inline-block; position: relative; width: 1.036em; height: 0px;"><span style="position: absolute; clip: rect(3.412em 1000.67em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-257" style="font-family: STIXGeneral; font-style: italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.674em;"><span class="mi" id="MathJax-Span-258" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>ω</mi><mi>r</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-21">\omega_r</script> is the trap frequency in the radial direction. To use this system, set <code>RHSType=1</code> in <code>params.in</code>.</p>
<p><em><strong>Note</strong>: Strictly speaking, a 2D mean-field description of an oblate trapped condensate is only valid when <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;msubsup&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msubsup&gt;&lt;/mrow&gt;&lt;msubsup&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/msubsup&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;mo&gt;&amp;#x226A;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-259" style="width: 5.323em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.393em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.829em 1004.29em 3.567em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-260"><span class="mstyle" id="MathJax-Span-261"><span class="mrow" id="MathJax-Span-262"><span class="mfrac" id="MathJax-Span-263"><span style="display: inline-block; position: relative; width: 2.12em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(2.998em 1001.97em 4.341em -999.997em); top: -4.646em; left: 50%; margin-left: -0.979em;"><span class="mrow" id="MathJax-Span-264"><span class="mi" id="MathJax-Span-265" style="font-family: STIXGeneral; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mi" id="MathJax-Span-266" style="font-family: STIXGeneral; font-style: italic;">a</span><span class="msubsup" id="MathJax-Span-267"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.26em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-268" style="font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.36em 1000.42em 4.135em -999.997em); top: -4.336em; left: 0.313em;"><span class="mn" id="MathJax-Span-269" style="font-size: 70.7%; font-family: STIXGeneral;">3</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.515em 1000.36em 4.186em -999.997em); top: -3.82em; left: 0.261em;"><span class="mi" id="MathJax-Span-270" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">z</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(2.998em 1000.78em 4.29em -999.997em); top: -3.148em; left: 50%; margin-left: -0.359em;"><span class="msubsup" id="MathJax-Span-271"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.26em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-272" style="font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.36em 1000.42em 4.135em -999.997em); top: -4.336em; left: 0.313em;"><span class="mn" id="MathJax-Span-273" style="font-size: 70.7%; font-family: STIXGeneral;">3</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.515em 1000.36em 4.135em -999.997em); top: -3.82em; left: 0.261em;"><span class="mi" id="MathJax-Span-274" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(0.881em 1002.12em 1.242em -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.12em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-275" style="font-family: STIXGeneral; padding-left: 0.313em;">≪</span><span class="mn" id="MathJax-Span-276" style="font-family: STIXGeneral; padding-left: 0.313em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.184em; border-left: 0px solid; width: 0px; height: 3.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi>N</mi><mi>a</mi><msubsup><mi>l</mi><mi>z</mi><mn>3</mn></msubsup></mrow><msubsup><mi>l</mi><mi>r</mi><mn>3</mn></msubsup></mfrac></mstyle><mo>≪</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-22">\dfrac{Nal_z^3}{l_r^3}\ll1</script>, where N is the number of atoms, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-277" style="width: 0.622em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.862em 1000.52em 2.637em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-278"><span class="mi" id="MathJax-Span-279" style="font-family: STIXGeneral; font-style: italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-23">a</script> is the s-wave scattering length and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msqrt&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;mi class=&quot;MJX-variant&quot;&gt;&amp;#x210F;&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;/msqrt&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-280" style="width: 6.253em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.168em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.829em 1005.17em 3.618em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-281"><span class="msubsup" id="MathJax-Span-282"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.26em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-283" style="font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.261em;"><span class="mi" id="MathJax-Span-284" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">z</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-285" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="msqrt" id="MathJax-Span-286" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 3.257em; height: 0px;"><span style="position: absolute; clip: rect(2.482em 1002.12em 5.013em -999.997em); top: -3.975em; left: 1.139em;"><span class="mrow" id="MathJax-Span-287"><span class="mstyle" id="MathJax-Span-288"><span class="mrow" id="MathJax-Span-289"><span class="mfrac" id="MathJax-Span-290"><span style="display: inline-block; position: relative; width: 1.862em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(3.153em 1000.57em 4.135em -999.997em); top: -4.646em; left: 50%; margin-left: -0.307em;"><span class="mi" id="MathJax-Span-291" style="font-family: STIXVariants;">ℏ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.36em 1001.76em 4.341em -999.997em); top: -3.303em; left: 50%; margin-left: -0.876em;"><span class="mrow" id="MathJax-Span-292"><span class="mi" id="MathJax-Span-293" style="font-family: STIXGeneral; font-style: italic;">m</span><span class="msubsup" id="MathJax-Span-294"><span style="display: inline-block; position: relative; width: 1.036em; height: 0px;"><span style="position: absolute; clip: rect(3.412em 1000.67em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-295" style="font-family: STIXGeneral; font-style: italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.674em;"><span class="mi" id="MathJax-Span-296" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">z</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(0.881em 1001.86em 1.242em -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.862em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(2.998em 1002.12em 3.36em -999.997em); top: -4.595em; left: 1.139em;"><span style="display: inline-block; position: relative; width: 2.12em; height: 0px;"><span style="position: absolute; font-family: STIXGeneral; top: -3.975em; left: 0em;">‾<span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; font-family: STIXGeneral; top: -3.975em; left: 1.655em;">‾<span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.975em; left: 0.416em;">‾<span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.975em; left: 0.829em;">‾<span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.975em; left: 1.242em;">‾<span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(1.759em 1001.14em 4.548em -999.997em); top: -3.407em; left: 0em;"><span style="font-family: STIXSizeTwoSym;">√</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>l</mi><mi>z</mi></msub><mo>=</mo><msqrt><mstyle displaystyle="true" scriptlevel="0"><mfrac><mi class="MJX-variant">ℏ</mi><mrow><mi>m</mi><msub><mi>ω</mi><mi>z</mi></msub></mrow></mfrac></mstyle></msqrt></math></span></span><script type="math/tex" id="MathJax-Element-24">l_z=\sqrt{\dfrac{\hbar}{m\omega_z}}</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msqrt&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;mi class=&quot;MJX-variant&quot;&gt;&amp;#x210F;&lt;/mi&gt;&lt;mrow&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;/msqrt&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-297" style="width: 6.356em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.22em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.829em 1005.22em 3.618em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-298"><span class="msubsup" id="MathJax-Span-299"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.26em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-300" style="font-family: STIXGeneral; font-style: italic;">l<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.261em;"><span class="mi" id="MathJax-Span-301" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-302" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="msqrt" id="MathJax-Span-303" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 3.308em; height: 0px;"><span style="position: absolute; clip: rect(2.482em 1002.12em 4.961em -999.997em); top: -3.975em; left: 1.139em;"><span class="mrow" id="MathJax-Span-304"><span class="mstyle" id="MathJax-Span-305"><span class="mrow" id="MathJax-Span-306"><span class="mfrac" id="MathJax-Span-307"><span style="display: inline-block; position: relative; width: 1.914em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(3.153em 1000.57em 4.135em -999.997em); top: -4.646em; left: 50%; margin-left: -0.307em;"><span class="mi" id="MathJax-Span-308" style="font-family: STIXVariants;">ℏ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.36em 1001.76em 4.29em -999.997em); top: -3.303em; left: 50%; margin-left: -0.876em;"><span class="mrow" id="MathJax-Span-309"><span class="mi" id="MathJax-Span-310" style="font-family: STIXGeneral; font-style: italic;">m</span><span class="msubsup" id="MathJax-Span-311"><span style="display: inline-block; position: relative; width: 1.036em; height: 0px;"><span style="position: absolute; clip: rect(3.412em 1000.67em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-312" style="font-family: STIXGeneral; font-style: italic;">ω</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.674em;"><span class="mi" id="MathJax-Span-313" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(0.881em 1001.91em 1.242em -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.914em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(2.998em 1002.17em 3.36em -999.997em); top: -4.646em; left: 1.139em;"><span style="display: inline-block; position: relative; width: 2.172em; height: 0px;"><span style="position: absolute; font-family: STIXGeneral; top: -3.975em; left: 0em;">‾<span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; font-family: STIXGeneral; top: -3.975em; left: 1.655em;">‾<span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.975em; left: 0.416em;">‾<span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.975em; left: 0.829em;">‾<span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="font-family: STIXGeneral; position: absolute; top: -3.975em; left: 1.242em;">‾<span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(1.759em 1001.14em 4.548em -999.997em); top: -3.407em; left: 0em;"><span style="font-family: STIXSizeTwoSym;">√</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>l</mi><mi>r</mi></msub><mo>=</mo><msqrt><mstyle displaystyle="true" scriptlevel="0"><mfrac><mi class="MJX-variant">ℏ</mi><mrow><mi>m</mi><msub><mi>ω</mi><mi>r</mi></msub></mrow></mfrac></mstyle></msqrt></math></span></span><script type="math/tex" id="MathJax-Element-25">l_r = \sqrt{\dfrac{\hbar}{m\omega_r}}</script> are the axial and radial harmonic oscillator lengths.</em></p>
<h3>
<a id="user-content-damped-gpe" class="anchor" href="file:///tmp/14.html#damped-gpe" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Damped GPE</h3>
<p>In both the harmonic trap system and the homogeneous system, an optional damping parameter can be applied. The damped version of the GPE is a very rough phenomenological simulation of finite temperature effects on BECs.</p>
<p>The damped GPE replaces the left hand side of the GPE with <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;&amp;#x03C8;&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-314" style="width: 4.961em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.083em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.984em 1004.08em 3.308em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-315"><span class="mo" id="MathJax-Span-316" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-317" style="font-family: STIXGeneral; font-style: italic;">i</span><span class="mo" id="MathJax-Span-318" style="font-family: STIXGeneral; padding-left: 0.261em;">−</span><span class="mi" id="MathJax-Span-319" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.261em;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-320" style="font-family: STIXGeneral;">)</span><span class="mstyle" id="MathJax-Span-321"><span class="mrow" id="MathJax-Span-322"><span class="mfrac" id="MathJax-Span-323"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(3.153em 1001.14em 4.341em -999.997em); top: -4.646em; left: 50%; margin-left: -0.566em;"><span class="mrow" id="MathJax-Span-324"><span class="mi" id="MathJax-Span-325" style="font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-326" style="font-family: STIXGeneral; font-style: italic;">ψ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.106em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.153em 1000.78em 4.135em -999.997em); top: -3.303em; left: 50%; margin-left: -0.359em;"><span class="mrow" id="MathJax-Span-327"><span class="mi" id="MathJax-Span-328" style="font-family: STIXGeneral;">∂</span><span class="mi" id="MathJax-Span-329" style="font-family: STIXGeneral; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(0.881em 1001.24em 1.242em -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.242em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.872em; border-left: 0px solid; width: 0px; height: 2.628em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>i</mi><mo>−</mo><mi>γ</mi><mo stretchy="false">)</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>ψ</mi></mrow><mrow><mi mathvariant="normal">∂</mi><mi>t</mi></mrow></mfrac></mstyle></math></span></span><script type="math/tex" id="MathJax-Element-26">(i-\gamma)\dfrac{\partial\psi}{\partial t}</script>, where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-330" style="width: 0.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.914em 1000.47em 2.843em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-331"><span class="mi" id="MathJax-Span-332" style="font-family: STIXGeneral; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>γ</mi></math></span></span><script type="math/tex" id="MathJax-Element-27">\gamma</script> is a small positive parameter controlling the rate of damping.</p>
<p>The value of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-333" style="width: 0.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.914em 1000.47em 2.843em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-334"><span class="mi" id="MathJax-Span-335" style="font-family: STIXGeneral; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>γ</mi></math></span></span><script type="math/tex" id="MathJax-Element-28">\gamma</script> can be set to 0.01, for example, by adding <code>GAMMAC=0.01d0</code> to <code>params.in</code>.</p>
<h1>
<a id="user-content-the-numerical-method" class="anchor" href="file:///tmp/14.html#the-numerical-method" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>The Numerical Method</h1>
<p>To solve the GPE, 2D-GP uses 4th order Runge-Kutta time stepping on a grid of points with regular spacing in both the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-336" style="width: 0.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.862em 1000.47em 2.637em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-337"><span class="mi" id="MathJax-Span-338" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-29">x</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-339" style="width: 0.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.862em 1000.47em 2.843em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-340"><span class="mi" id="MathJax-Span-341" style="font-family: STIXGeneral; font-style: italic;">y</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-30">y</script> dimensions. There are three main modes of time stepping. <code>ISTEPS</code> controls how many steps to run <em>imaginary time propagation</em>, <code>DSTEPS</code> controls how many steps to run with a <em>highly damped propagation</em>, and <code>NSTEPS</code> controls how many steps of <em>real time propagation</em> to run.</p>
<p>You will want <code>ISTEPS</code> and <code>DSTEPS</code> to be small or zero, used simply to setup the system, with the majority of time spent running <code>NSTEPS</code> of real-time simulation.</p>
<h3>
<a id="user-content-imaginary-time-propagation" class="anchor" href="file:///tmp/14.html#imaginary-time-propagation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Imaginary Time Propagation</h3>
<p>For imaginary time propagation we move from real to imaginary time using the substitution <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-342" style="width: 3.773em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.102em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.655em 1003.1em 2.792em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-343"><span class="msubsup" id="MathJax-Span-344"><span style="display: inline-block; position: relative; width: 0.571em; height: 0px;"><span style="position: absolute; clip: rect(3.257em 1000.31em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-345" style="font-family: STIXGeneral; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.261em;"><span class="mi" id="MathJax-Span-346" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-347" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mo" id="MathJax-Span-348" style="font-family: STIXGeneral; padding-left: 0.313em;">−</span><span class="mi" id="MathJax-Span-349" style="font-family: STIXGeneral; font-style: italic;">i</span><span class="mi" id="MathJax-Span-350" style="font-family: STIXGeneral; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>t</mi><mi>i</mi></msub><mo>=</mo><mo>−</mo><mi>i</mi><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-31">t_i = -it</script>. This transforms the GPE into a form similar to a diffusion equation. As a result, a local equilibrium can be found by propagating through time. This causes the system to approach a ground state solution. The cost of using a diffusion equation is that solution decays over time. We inhibit the overall decay of the wavefunction by renormalising during imaginary time propagation. The imaginary time propagation method converges on the ground state solution very slowly and so we must perform many numerical steps to prepare an initial state.</p>
<p>The renormalisation step forces the solution to have a constant norm throughout imaginary time propagation. The norm that the system is renormalised to depends on the choice of GPE units, but it is fundamentally an approximation based on the size of the condensate and the imposed potential, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-351" style="width: 0.829em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.655em 1000.67em 2.637em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-352"><span class="mi" id="MathJax-Span-353" style="font-family: STIXGeneral; font-style: italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>V</mi></math></span></span><script type="math/tex" id="MathJax-Element-32">V</script>. This works well when <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-354" style="width: 2.792em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.275em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.655em 1002.27em 2.843em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-355"><span class="mi" id="MathJax-Span-356" style="font-family: STIXGeneral; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-357" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mn" id="MathJax-Span-358" style="font-family: STIXGeneral; padding-left: 0.313em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>γ</mi><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-33">\gamma=0</script>, because then the energy and norm are conserved during real time simulation. However, when <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;mo&gt;&amp;#x2260;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-359" style="width: 2.792em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.275em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.655em 1002.27em 2.843em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-360"><span class="mi" id="MathJax-Span-361" style="font-family: STIXGeneral; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-362" style="font-family: STIXGeneral; padding-left: 0.313em;">≠</span><span class="mn" id="MathJax-Span-363" style="font-family: STIXGeneral; padding-left: 0.313em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>γ</mi><mo>≠</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-34">\gamma \ne 0</script> the system is slightly dissipative and so the energy and norm change over time to approach the energy and norm of the true ground state solution. If the norm approximation by 2D-GP is particularly bad, this can be noticeable.</p>
<p>Imaginary time propagation is run before the initial condition defined in the file <code>ic.in</code> is multiplied into the system.</p>
<h3>
<a id="user-content-highly-damped-propagation" class="anchor" href="file:///tmp/14.html#highly-damped-propagation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Highly Damped Propagation</h3>
<p>After imaginary time propagation, initial conditions (defined in <code>ic.in</code>) are applied and the system is run with a highly damped GPE for <code>DSTEPS</code> steps. During this period the system will continue to approach the ground state. Running highly damped propagation for a short amount of time has two benefits:</p>
<ul>
<li>If your initial condition in <code>ic.in</code> is a combination of several solutions multiplied into the system, the resulting wavefunction is most likely not a true solution of the GPE and so an immediate emission of sound can occur. With highly damped propagation the initial start to the simulation is 'smoothed' as any emitted sound is damped away</li>
<li>If the norm approximation used by 2D-GP in imaginary time propagation is particularly bad, running the system highly damped for a short amount of time forced the norm of the system to approach the norm of the true ground state solution.</li>
</ul>
<p>By default, the phase of the system is continually enforced during this period. This can be disabled by setting <code>HOLDIC = .false.</code>. However, in this case <code>DSTEPS</code> should be small if you are using a complicated <code>ic.in</code>. Vortices, in particular, will approach each other and annihilate unless the phase of the system is enforced throughout.</p>
<h3>
<a id="user-content-real-time-propagation" class="anchor" href="file:///tmp/14.html#real-time-propagation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Real Time Propagation</h3>
<p>After highly damped propagation, numerical noise is optionally applied to break symmetry (with e.g. <code>noiseamp=0.05d0</code> in <code>params.in</code>) and the system is run normally for <code>NSTEPS</code> steps. This is where the majority of GPE simulation occurs and by default it is only the output wavefunction data from this mode that is written to disk.</p>
<h3>
<a id="user-content-boundary-conditions" class="anchor" href="file:///tmp/14.html#boundary-conditions" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Boundary Conditions</h3>
<p><strong>Reflective</strong>, <strong>periodic</strong> and <strong>zero</strong> boundary conditions are supported and can be independently applied to the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-364" style="width: 0.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.862em 1000.47em 2.637em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-365"><span class="mi" id="MathJax-Span-366" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-35">x</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-367" style="width: 0.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.862em 1000.47em 2.843em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-368"><span class="mi" id="MathJax-Span-369" style="font-family: STIXGeneral; font-style: italic;">y</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-36">y</script> directions.</p>
<p><code>BCX</code> controls the boundary conditions in the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-370" style="width: 0.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.862em 1000.47em 2.637em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-371"><span class="mi" id="MathJax-Span-372" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-37">x</script> direction and <code>BCY</code> controls the boundary conditions in the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-373" style="width: 0.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.862em 1000.47em 2.843em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-374"><span class="mi" id="MathJax-Span-375" style="font-family: STIXGeneral; font-style: italic;">y</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-38">y</script> direction. Set to 0 for reflective, 1 for periodic, 2 for zero.</p>
<h1>
<a id="user-content-adding-an-initial-condition" class="anchor" href="file:///tmp/14.html#adding-an-initial-condition" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Adding an Initial Condition</h1>
<p>An initial condition can be imprinted (such as imprinting vortices) at the start of the simulation. <code>ISTEPS</code> and <code>DSTEPS</code> should be tweaked to reflect how much imaginary time propagation you would like before and after the imprinting.</p>
<p>To add an initial condition, after running <code>make2dgp</code> in an empty directory edit the file <code>ic.in</code> with Fortran code to be run. Some vortex imprinting functions are provided in the file <code>utils.f95</code>. An example ic.in could be:</p>
<pre><code>!Enter initial conditions in the form
!call IC(...)
!
call insert_vortex(-10.0d0,0.0d0,1)
call insert_vortex(10.0d0,0.0d0,-1)
</code></pre>
<p>This imprints a vortex phase and density profile at <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-376" style="width: 7.182em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.943em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.655em 1005.89em 2.843em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-377"><span class="mi" id="MathJax-Span-378" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-379" style="font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-380" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.209em;">y</span><span class="mo" id="MathJax-Span-381" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mo" id="MathJax-Span-382" style="font-family: STIXGeneral; padding-left: 0.313em;">(</span><span class="mo" id="MathJax-Span-383" style="font-family: STIXGeneral;">−</span><span class="mn" id="MathJax-Span-384" style="font-family: STIXGeneral;">10</span><span class="mo" id="MathJax-Span-385" style="font-family: STIXGeneral;">,</span><span class="mn" id="MathJax-Span-386" style="font-family: STIXGeneral; padding-left: 0.209em;">0</span><span class="mo" id="MathJax-Span-387" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>,</mo><mi>y</mi><mo>=</mo><mo stretchy="false">(</mo><mo>−</mo><mn>10</mn><mo>,</mo><mn>0</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-39">x,y=(-10,0)</script> with positive circulation, and a vortex phase and density profile at <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-40-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-388" style="width: 6.408em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.271em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.655em 1005.22em 2.843em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-389"><span class="mi" id="MathJax-Span-390" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-391" style="font-family: STIXGeneral;">,</span><span class="mi" id="MathJax-Span-392" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.209em;">y</span><span class="mo" id="MathJax-Span-393" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mo" id="MathJax-Span-394" style="font-family: STIXGeneral; padding-left: 0.313em;">(</span><span class="mn" id="MathJax-Span-395" style="font-family: STIXGeneral;">10</span><span class="mo" id="MathJax-Span-396" style="font-family: STIXGeneral;">,</span><span class="mn" id="MathJax-Span-397" style="font-family: STIXGeneral; padding-left: 0.209em;">0</span><span class="mo" id="MathJax-Span-398" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>,</mo><mi>y</mi><mo>=</mo><mo stretchy="false">(</mo><mn>10</mn><mo>,</mo><mn>0</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-40">x,y=(10,0)</script> with negative circulation.</p>
<p>The <code>GRID</code> Fortran variable contains the system wavefunction, it is this variable you should make changes to apply some initial condition. For a complex setup involving temporary variables, you should create a new function in <code>utils.f95</code> (using <code>insert_vortex</code> as a template) and call your new function from <code>ic.in</code>.</p>
<h1>
<a id="user-content-trapping-and-obstacle-potentials" class="anchor" href="file:///tmp/14.html#trapping-and-obstacle-potentials" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Trapping and Obstacle Potentials</h1>
<p>Trapping and obstacle potentials are controlled separately and combined by 2D-GP to form the potential term in the GPE, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-41-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;trap&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;obj&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-399" style="width: 7.957em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.563em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.655em 1006.56em 2.947em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-400"><span class="mi" id="MathJax-Span-401" style="font-family: STIXGeneral; font-style: italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-402" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-403" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.81em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.67em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-404" style="font-family: STIXGeneral; font-style: italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.622em;"><span class="texatom" id="MathJax-Span-405"><span class="mrow" id="MathJax-Span-406"><span class="mtext" id="MathJax-Span-407" style="font-size: 70.7%; font-family: STIXGeneral;">trap</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-408" style="font-family: STIXGeneral; padding-left: 0.261em;">+</span><span class="msubsup" id="MathJax-Span-409" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 1.604em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.67em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-410" style="font-family: STIXGeneral; font-style: italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.622em;"><span class="texatom" id="MathJax-Span-411"><span class="mrow" id="MathJax-Span-412"><span class="mtext" id="MathJax-Span-413" style="font-size: 70.7%; font-family: STIXGeneral;">obj</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>V</mi><mo>=</mo><msub><mi>V</mi><mrow class="MJX-TeXAtom-ORD"><mtext>trap</mtext></mrow></msub><mo>+</mo><msub><mi>V</mi><mrow class="MJX-TeXAtom-ORD"><mtext>obj</mtext></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-41">V = V_{\text{trap}}+V_{\text{obj}}</script>. The potential is measured in units of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-42-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03BC;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-414" style="width: 0.622em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.519em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.914em 1000.47em 2.843em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-415"><span class="mi" id="MathJax-Span-416" style="font-family: STIXGeneral; font-style: italic;">μ</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>μ</mi></math></span></span><script type="math/tex" id="MathJax-Element-42">\mu</script>.</p>
<h2>
<a id="user-content-trapping-potential-v_texttrap" class="anchor" href="file:///tmp/14.html#trapping-potential-v_texttrap" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Trapping Potential <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-43-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;trap&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-417" style="width: 2.144em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.787em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.46em 1001.79em 2.591em -999.999em); top: -2.201em; left: 0em;"><span class="mrow" id="MathJax-Span-418"><span class="msubsup" id="MathJax-Span-419"><span style="display: inline-block; position: relative; width: 1.787em; height: 0px;"><span style="position: absolute; clip: rect(3.246em 1000.69em 4.109em -999.999em); top: -3.987em; left: 0em;"><span class="mi" id="MathJax-Span-420" style="font-family: STIXGeneral; font-style: italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.091em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.838em; left: 0.626em;"><span class="texatom" id="MathJax-Span-421"><span class="mrow" id="MathJax-Span-422"><span class="mtext" id="MathJax-Span-423" style="font-size: 70.7%; font-family: STIXGeneral;">trap</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.204em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.391em; border-left: 0px solid; width: 0px; height: 1.216em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>V</mi><mrow class="MJX-TeXAtom-ORD"><mtext>trap</mtext></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-43">V_{\text{trap}}</script></h2>
<p>To enable a trapping potential, set <code>enableTrap=.true.</code> in <code>params.in</code>. The type of trapping potential is chosen by setting the <code>trapType</code> variable.</p>
<h3>
<a id="user-content-harmonic-trap" class="anchor" href="file:///tmp/14.html#harmonic-trap" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Harmonic Trap</h3>
<p><code>trapType=0</code> sets up a standard trapping potential for use with a harmonically trapped system, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-44-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;trap&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;msup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mfrac&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-424" style="width: 5.581em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.6em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.829em 1004.55em 3.308em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-425"><span class="msubsup" id="MathJax-Span-426"><span style="display: inline-block; position: relative; width: 1.81em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.67em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-427" style="font-family: STIXGeneral; font-style: italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.622em;"><span class="texatom" id="MathJax-Span-428"><span class="mrow" id="MathJax-Span-429"><span class="mtext" id="MathJax-Span-430" style="font-size: 70.7%; font-family: STIXGeneral;">trap</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-431" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mfrac" id="MathJax-Span-432" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.036em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(2.998em 1000.88em 4.135em -999.997em); top: -4.646em; left: 50%; margin-left: -0.462em;"><span class="msubsup" id="MathJax-Span-433"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em 1000.42em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-434" style="font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.336em; left: 0.467em;"><span class="mn" id="MathJax-Span-435" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.153em 1000.47em 4.135em -999.997em); top: -3.303em; left: 50%; margin-left: -0.256em;"><span class="mn" id="MathJax-Span-436" style="font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(0.881em 1001.04em 1.242em -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.036em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span><span class="mo" id="MathJax-Span-437" style="font-family: STIXGeneral;">.</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.872em; border-left: 0px solid; width: 0px; height: 2.816em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>V</mi><mrow class="MJX-TeXAtom-ORD"><mtext>trap</mtext></mrow></msub><mo>=</mo><mfrac><msup><mi>r</mi><mn>2</mn></msup><mn>2</mn></mfrac><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-44">V_{\text{trap}} = \frac{r^2}{2}.</script></p>
<h3>
<a id="user-content-hard-circle-trap" class="anchor" href="file:///tmp/14.html#hard-circle-trap" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Hard Circle Trap</h3>
<p><code>trapType=1</code> sets up a hard wall potential that takes the value of 0 inside the trap boundary and some maximum value outside. The shape of the trap boundary is a circle,
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-45-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;trap&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;{&lt;/mo&gt;&lt;mtable columnalign=&quot;left left&quot; rowspacing=&quot;.2em&quot; columnspacing=&quot;1em&quot; displaystyle=&quot;false&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;max&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;mtext&gt;if&amp;#xA0;&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mtext&gt;,&lt;/mtext&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mtext&gt;otherwise.&lt;/mtext&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo fence=&quot;true&quot; stretchy=&quot;true&quot; symmetric=&quot;true&quot;&gt;&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-438" style="width: 14.414em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.883em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(2.275em 1011.88em 4.806em -999.997em); top: -3.768em; left: 0em;"><span class="mrow" id="MathJax-Span-439"><span class="msubsup" id="MathJax-Span-440"><span style="display: inline-block; position: relative; width: 1.81em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.67em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-441" style="font-family: STIXGeneral; font-style: italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.622em;"><span class="texatom" id="MathJax-Span-442"><span class="mrow" id="MathJax-Span-443"><span class="mtext" id="MathJax-Span-444" style="font-size: 70.7%; font-family: STIXGeneral;">trap</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-445" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mrow" id="MathJax-Span-446" style="padding-left: 0.313em;"><span class="mo" id="MathJax-Span-447" style="vertical-align: -0.462em;"><span><span style="font-size: 111%; font-family: STIXSizeTwoSym;">{</span></span></span><span class="mtable" id="MathJax-Span-448" style="padding-right: 0.158em; padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 7.647em; height: 0px;"><span style="position: absolute; clip: rect(2.585em 1002.07em 4.961em -999.997em); top: -3.975em; left: 0em;"><span style="display: inline-block; position: relative; width: 2.12em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1002.07em 4.29em -999.997em); top: -4.543em; left: 0em;"><span class="mtd" id="MathJax-Span-449"><span class="mrow" id="MathJax-Span-450"><span class="msubsup" id="MathJax-Span-451"><span style="display: inline-block; position: relative; width: 1.862em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.62em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-452" style="font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="texatom" id="MathJax-Span-453"><span class="mrow" id="MathJax-Span-454"><span class="mtext" id="MathJax-Span-455" style="font-size: 70.7%; font-family: STIXGeneral;">max</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-456" style="font-family: STIXGeneral;">,</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.153em 1000.67em 4.29em -999.997em); top: -3.303em; left: 0em;"><span class="mtd" id="MathJax-Span-475"><span class="mrow" id="MathJax-Span-476"><span class="mn" id="MathJax-Span-477" style="font-family: STIXGeneral;">0</span><span class="mo" id="MathJax-Span-478" style="font-family: STIXGeneral;">,</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(2.585em 1004.34em 4.806em -999.997em); top: -3.975em; left: 3.205em;"><span style="display: inline-block; position: relative; width: 4.393em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1004.34em 4.341em -999.997em); top: -4.543em; left: 0em;"><span class="mtd" id="MathJax-Span-457"><span class="mrow" id="MathJax-Span-458"><span class="mrow" id="MathJax-Span-459"><span class="mtext" id="MathJax-Span-460" style="font-family: STIXGeneral;">if&nbsp;</span><span class="texatom" id="MathJax-Span-461"><span class="mrow" id="MathJax-Span-462"><span class="texatom" id="MathJax-Span-463"><span class="mrow" id="MathJax-Span-464"><span class="mo" id="MathJax-Span-465" style="font-family: STIXVariants;">|</span></span></span><span class="mi" id="MathJax-Span-466" style="font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-467"><span class="mrow" id="MathJax-Span-468"><span class="mo" id="MathJax-Span-469" style="font-family: STIXVariants;">|</span></span></span><span class="mo" id="MathJax-Span-470" style="font-family: STIXGeneral; padding-left: 0.313em;">&gt;</span><span class="msubsup" id="MathJax-Span-471" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.62em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-472" style="font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="mi" id="MathJax-Span-473" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span class="mtext" id="MathJax-Span-474" style="font-family: STIXGeneral;">,</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.153em 1004.08em 4.135em -999.997em); top: -3.303em; left: 0em;"><span class="mtd" id="MathJax-Span-479"><span class="mrow" id="MathJax-Span-480"><span class="mtext" id="MathJax-Span-481" style="font-family: STIXGeneral;">otherwise.</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-482"></span></span></span><span style="display: inline-block; width: 0px; height: 3.773em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.122em; border-left: 0px solid; width: 0px; height: 2.816em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>V</mi><mrow class="MJX-TeXAtom-ORD"><mtext>trap</mtext></mrow></msub><mo>=</mo><mrow><mo>{</mo><mtable columnalign="left left" rowspacing=".2em" columnspacing="1em" displaystyle="false"><mtr><mtd><msub><mi>T</mi><mrow class="MJX-TeXAtom-ORD"><mtext>max</mtext></mrow></msub><mo>,</mo></mtd><mtd><mrow><mtext>if&nbsp;</mtext><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>&gt;</mo><msub><mi>T</mi><mi>r</mi></msub></mrow><mtext>,</mtext></mrow></mtd></mtr><mtr><mtd><mn>0</mn><mo>,</mo></mtd><mtd><mtext>otherwise.</mtext></mtd></mtr></mtable><mo fence="true" stretchy="true" symmetric="true"></mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-45">V_{\text{trap}} = \begin{cases}
T_{\text{max}},  & \text{if $|r|>T_r$,}\cr
0, & \text{otherwise.}
\end{cases}</script>
where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-46-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;max&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-483" style="width: 2.275em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.862em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em 1001.86em 2.482em -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-484"><span class="msubsup" id="MathJax-Span-485"><span style="display: inline-block; position: relative; width: 1.862em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.62em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-486" style="font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="texatom" id="MathJax-Span-487"><span class="mrow" id="MathJax-Span-488"><span class="mtext" id="MathJax-Span-489" style="font-size: 70.7%; font-family: STIXGeneral;">max</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mrow class="MJX-TeXAtom-ORD"><mtext>max</mtext></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-46">T_{\text{max}}</script> (<code>TRAPHEIGHT</code>) is the maximum value of the trapping potential and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-47-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-490" style="width: 1.139em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em 1000.93em 2.482em -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-491"><span class="msubsup" id="MathJax-Span-492"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.62em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-493" style="font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="mi" id="MathJax-Span-494" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mi>r</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-47">T_r</script> (<code>TRAPR</code>) is the radius of the boundary.</p>
<h3>
<a id="user-content-hard-box-trap" class="anchor" href="file:///tmp/14.html#hard-box-trap" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Hard Box Trap</h3>
<p><code>trapType=2</code> sets up a hard wall potential that takes the value of 0 inside the trap boundary and some maximum value outside. The shape of the trap boundary is a box,
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-48-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;trap&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;{&lt;/mo&gt;&lt;mtable columnalign=&quot;left left&quot; rowspacing=&quot;.2em&quot; columnspacing=&quot;1em&quot; displaystyle=&quot;false&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;max&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;mtext&gt;if&amp;#xA0;&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mtext&gt;&amp;#xA0;or&amp;#xA0;&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mtext&gt;,&lt;/mtext&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mtext&gt;otherwise,&lt;/mtext&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo fence=&quot;true&quot; stretchy=&quot;true&quot; symmetric=&quot;true&quot;&gt;&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-495" style="width: 20.044em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.532em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(2.275em 1016.53em 4.806em -999.997em); top: -3.768em; left: 0em;"><span class="mrow" id="MathJax-Span-496"><span class="msubsup" id="MathJax-Span-497"><span style="display: inline-block; position: relative; width: 1.81em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.67em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-498" style="font-family: STIXGeneral; font-style: italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.622em;"><span class="texatom" id="MathJax-Span-499"><span class="mrow" id="MathJax-Span-500"><span class="mtext" id="MathJax-Span-501" style="font-size: 70.7%; font-family: STIXGeneral;">trap</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-502" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mrow" id="MathJax-Span-503" style="padding-left: 0.313em;"><span class="mo" id="MathJax-Span-504" style="vertical-align: -0.462em;"><span><span style="font-size: 111%; font-family: STIXSizeTwoSym;">{</span></span></span><span class="mtable" id="MathJax-Span-505" style="padding-right: 0.158em; padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 12.296em; height: 0px;"><span style="position: absolute; clip: rect(2.585em 1002.07em 4.961em -999.997em); top: -3.975em; left: 0em;"><span style="display: inline-block; position: relative; width: 2.12em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1002.07em 4.29em -999.997em); top: -4.543em; left: 0em;"><span class="mtd" id="MathJax-Span-506"><span class="mrow" id="MathJax-Span-507"><span class="msubsup" id="MathJax-Span-508"><span style="display: inline-block; position: relative; width: 1.862em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.62em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-509" style="font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="texatom" id="MathJax-Span-510"><span class="mrow" id="MathJax-Span-511"><span class="mtext" id="MathJax-Span-512" style="font-size: 70.7%; font-family: STIXGeneral;">max</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-513" style="font-family: STIXGeneral;">,</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.153em 1000.67em 4.29em -999.997em); top: -3.303em; left: 0em;"><span class="mtd" id="MathJax-Span-546"><span class="mrow" id="MathJax-Span-547"><span class="mn" id="MathJax-Span-548" style="font-family: STIXGeneral;">0</span><span class="mo" id="MathJax-Span-549" style="font-family: STIXGeneral;">,</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(2.585em 1009.04em 4.961em -999.997em); top: -3.975em; left: 3.205em;"><span style="display: inline-block; position: relative; width: 9.093em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1009.04em 4.341em -999.997em); top: -4.543em; left: 0em;"><span class="mtd" id="MathJax-Span-514"><span class="mrow" id="MathJax-Span-515"><span class="mrow" id="MathJax-Span-516"><span class="mtext" id="MathJax-Span-517" style="font-family: STIXGeneral;">if&nbsp;</span><span class="texatom" id="MathJax-Span-518"><span class="mrow" id="MathJax-Span-519"><span class="texatom" id="MathJax-Span-520"><span class="mrow" id="MathJax-Span-521"><span class="mo" id="MathJax-Span-522" style="font-family: STIXVariants;">|</span></span></span><span class="mi" id="MathJax-Span-523" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-524"><span class="mrow" id="MathJax-Span-525"><span class="mo" id="MathJax-Span-526" style="font-family: STIXVariants;">|</span></span></span><span class="mo" id="MathJax-Span-527" style="font-family: STIXGeneral; padding-left: 0.313em;">&gt;</span><span class="msubsup" id="MathJax-Span-528" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.62em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-529" style="font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="mi" id="MathJax-Span-530" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span class="mtext" id="MathJax-Span-531" style="font-family: STIXGeneral;">&nbsp;or&nbsp;</span><span class="texatom" id="MathJax-Span-532"><span class="mrow" id="MathJax-Span-533"><span class="texatom" id="MathJax-Span-534"><span class="mrow" id="MathJax-Span-535"><span class="mo" id="MathJax-Span-536" style="font-family: STIXVariants;">|</span></span></span><span class="mi" id="MathJax-Span-537" style="font-family: STIXGeneral; font-style: italic;">y</span><span class="texatom" id="MathJax-Span-538"><span class="mrow" id="MathJax-Span-539"><span class="mo" id="MathJax-Span-540" style="font-family: STIXVariants;">|</span></span></span><span class="mo" id="MathJax-Span-541" style="font-family: STIXGeneral; padding-left: 0.313em;">&gt;</span><span class="msubsup" id="MathJax-Span-542" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.62em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-543" style="font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="mi" id="MathJax-Span-544" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span><span class="mtext" id="MathJax-Span-545" style="font-family: STIXGeneral;">,</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.153em 1004.08em 4.29em -999.997em); top: -3.303em; left: 0em;"><span class="mtd" id="MathJax-Span-550"><span class="mrow" id="MathJax-Span-551"><span class="mtext" id="MathJax-Span-552" style="font-family: STIXGeneral;">otherwise,</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-553"></span></span></span><span style="display: inline-block; width: 0px; height: 3.773em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.122em; border-left: 0px solid; width: 0px; height: 2.816em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>V</mi><mrow class="MJX-TeXAtom-ORD"><mtext>trap</mtext></mrow></msub><mo>=</mo><mrow><mo>{</mo><mtable columnalign="left left" rowspacing=".2em" columnspacing="1em" displaystyle="false"><mtr><mtd><msub><mi>T</mi><mrow class="MJX-TeXAtom-ORD"><mtext>max</mtext></mrow></msub><mo>,</mo></mtd><mtd><mrow><mtext>if&nbsp;</mtext><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>&gt;</mo><msub><mi>T</mi><mi>r</mi></msub></mrow><mtext>&nbsp;or&nbsp;</mtext><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>&gt;</mo><msub><mi>T</mi><mi>r</mi></msub></mrow><mtext>,</mtext></mrow></mtd></mtr><mtr><mtd><mn>0</mn><mo>,</mo></mtd><mtd><mtext>otherwise,</mtext></mtd></mtr></mtable><mo fence="true" stretchy="true" symmetric="true"></mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-48">V_{\text{trap}} = \begin{cases}
T_{\text{max}},  & \text{if $|x|>T_r$ or $|y|>T_r$,}\cr
0, & \text{otherwise,}
\end{cases}</script>
where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-49-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;max&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-554" style="width: 2.275em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.862em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em 1001.86em 2.482em -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-555"><span class="msubsup" id="MathJax-Span-556"><span style="display: inline-block; position: relative; width: 1.862em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.62em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-557" style="font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="texatom" id="MathJax-Span-558"><span class="mrow" id="MathJax-Span-559"><span class="mtext" id="MathJax-Span-560" style="font-size: 70.7%; font-family: STIXGeneral;">max</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mrow class="MJX-TeXAtom-ORD"><mtext>max</mtext></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-49">T_{\text{max}}</script> (<code>TRAPHEIGHT</code>) is the maximum value of the trapping potential and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-50-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-561" style="width: 1.139em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em 1000.93em 2.482em -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-562"><span class="msubsup" id="MathJax-Span-563"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.62em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-564" style="font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="mi" id="MathJax-Span-565" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mi>r</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-50">T_r</script> (<code>TRAPR</code>) is a the size of the bounding box.</p>
<h3>
<a id="user-content-soft-circle-trap" class="anchor" href="file:///tmp/14.html#soft-circle-trap" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Soft Circle Trap</h3>
<p><code>trapType=3</code> sets up a smoothly varying potential that takes the value of 0 inside the trap boundary and some maximum value outside. The shape of the trap boundary is a circle,
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-51-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;trap&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;max&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-566" style="width: 10.901em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.99em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.984em 1008.94em 3.463em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-567"><span class="msubsup" id="MathJax-Span-568"><span style="display: inline-block; position: relative; width: 1.81em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.67em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-569" style="font-family: STIXGeneral; font-style: italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.622em;"><span class="texatom" id="MathJax-Span-570"><span class="mrow" id="MathJax-Span-571"><span class="mtext" id="MathJax-Span-572" style="font-size: 70.7%; font-family: STIXGeneral;">trap</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-573" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mfrac" id="MathJax-Span-574" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 5.426em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(3.153em 1001.86em 4.29em -999.997em); top: -4.646em; left: 50%; margin-left: -0.927em;"><span class="msubsup" id="MathJax-Span-575"><span style="display: inline-block; position: relative; width: 1.862em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.62em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-576" style="font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="texatom" id="MathJax-Span-577"><span class="mrow" id="MathJax-Span-578"><span class="mtext" id="MathJax-Span-579" style="font-size: 70.7%; font-family: STIXGeneral;">max</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(2.998em 1005.27em 4.186em -999.997em); top: -3.2em; left: 50%; margin-left: -2.632em;"><span class="mrow" id="MathJax-Span-580"><span class="mn" id="MathJax-Span-581" style="font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-582" style="font-family: STIXGeneral; padding-left: 0.261em;">+</span><span class="msubsup" id="MathJax-Span-583" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 3.567em; height: 0px;"><span style="position: absolute; clip: rect(3.36em 1000.42em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-584" style="font-family: STIXGeneral; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.285em; left: 0.467em;"><span class="texatom" id="MathJax-Span-585"><span class="mrow" id="MathJax-Span-586"><span class="msubsup" id="MathJax-Span-587"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px;"><span style="position: absolute; clip: rect(3.36em 1000.47em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-588" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.416em;"><span class="texatom" id="MathJax-Span-589"><span class="mrow" id="MathJax-Span-590"><span class="mi" id="MathJax-Span-591" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-592" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-593"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px;"><span style="position: absolute; clip: rect(3.36em 1000.47em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-594" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.416em;"><span class="mi" id="MathJax-Span-595" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-596" style="font-size: 70.7%; font-family: STIXGeneral;">−</span><span class="texatom" id="MathJax-Span-597"><span class="mrow" id="MathJax-Span-598"><span class="mo" id="MathJax-Span-599" style="font-size: 70.7%; font-family: STIXVariants;">|</span></span></span><span class="mi" id="MathJax-Span-600" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-601"><span class="mrow" id="MathJax-Span-602"><span class="mo" id="MathJax-Span-603" style="font-size: 70.7%; font-family: STIXVariants;">|</span></span></span><span class="mo" id="MathJax-Span-604" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(0.881em 1005.43em 1.242em -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 5.426em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span><span class="mo" id="MathJax-Span-605" style="font-family: STIXGeneral;">,</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.059em; border-left: 0px solid; width: 0px; height: 2.753em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>V</mi><mrow class="MJX-TeXAtom-ORD"><mtext>trap</mtext></mrow></msub><mo>=</mo><mfrac><msub><mi>T</mi><mrow class="MJX-TeXAtom-ORD"><mtext>max</mtext></mrow></msub><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>T</mi><mrow class="MJX-TeXAtom-ORD"><mi>β</mi></mrow></msub><mo stretchy="false">(</mo><msub><mi>T</mi><mi>r</mi></msub><mo>−</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo stretchy="false">)</mo></mrow></msup></mrow></mfrac><mo>,</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-51">V_{\text{trap}} = \frac{T_{\text{max}}}{1+e^{T_{\beta}(T_r-|r|)}},</script>
where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-52-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;max&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-606" style="width: 2.275em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.862em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em 1001.86em 2.482em -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-607"><span class="msubsup" id="MathJax-Span-608"><span style="display: inline-block; position: relative; width: 1.862em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.62em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-609" style="font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="texatom" id="MathJax-Span-610"><span class="mrow" id="MathJax-Span-611"><span class="mtext" id="MathJax-Span-612" style="font-size: 70.7%; font-family: STIXGeneral;">max</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mrow class="MJX-TeXAtom-ORD"><mtext>max</mtext></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-52">T_{\text{max}}</script> (<code>TRAPHEIGHT</code>) is the maximum value of the trapping potential, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-53-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-613" style="width: 1.139em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em 1000.93em 2.482em -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-614"><span class="msubsup" id="MathJax-Span-615"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.62em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-616" style="font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="mi" id="MathJax-Span-617" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mi>r</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-53">T_r</script> (<code>TRAPR</code>) is the radius of the bounding circle, and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-54-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-618" style="width: 1.191em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em 1000.98em 2.637em -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-619"><span class="msubsup" id="MathJax-Span-620"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.62em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-621" style="font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="texatom" id="MathJax-Span-622"><span class="mrow" id="MathJax-Span-623"><span class="mi" id="MathJax-Span-624" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mrow class="MJX-TeXAtom-ORD"><mi>β</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-54">T_{\beta}</script> (<code>TRAPBETA</code>) controls the steepness of the soft wall.</p>
<h3>
<a id="user-content-soft-box-trap" class="anchor" href="file:///tmp/14.html#soft-box-trap" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Soft Box Trap</h3>
<p><code>trapType=4</code> sets up a smoothly varying potential that takes the value of 0 inside the trap boundary and some maximum value outside. The potential is defined in terms of
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-55-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;box&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;max&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;max&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-625" style="width: 19.166em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.808em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(0.984em 1015.76em 3.463em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-626"><span class="msubsup" id="MathJax-Span-627"><span style="display: inline-block; position: relative; width: 1.759em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.67em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-628" style="font-family: STIXGeneral; font-style: italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.622em;"><span class="texatom" id="MathJax-Span-629"><span class="mrow" id="MathJax-Span-630"><span class="mtext" id="MathJax-Span-631" style="font-size: 70.7%; font-family: STIXGeneral;">box</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-632" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mfrac" id="MathJax-Span-633" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 5.426em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(3.153em 1001.86em 4.29em -999.997em); top: -4.646em; left: 50%; margin-left: -0.927em;"><span class="msubsup" id="MathJax-Span-634"><span style="display: inline-block; position: relative; width: 1.862em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.62em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-635" style="font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="texatom" id="MathJax-Span-636"><span class="mrow" id="MathJax-Span-637"><span class="mtext" id="MathJax-Span-638" style="font-size: 70.7%; font-family: STIXGeneral;">max</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(2.998em 1005.32em 4.186em -999.997em); top: -3.2em; left: 50%; margin-left: -2.632em;"><span class="mrow" id="MathJax-Span-639"><span class="mn" id="MathJax-Span-640" style="font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-641" style="font-family: STIXGeneral; padding-left: 0.261em;">+</span><span class="msubsup" id="MathJax-Span-642" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 3.618em; height: 0px;"><span style="position: absolute; clip: rect(3.36em 1000.42em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-643" style="font-family: STIXGeneral; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.285em; left: 0.467em;"><span class="texatom" id="MathJax-Span-644"><span class="mrow" id="MathJax-Span-645"><span class="msubsup" id="MathJax-Span-646"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px;"><span style="position: absolute; clip: rect(3.36em 1000.47em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-647" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.416em;"><span class="texatom" id="MathJax-Span-648"><span class="mrow" id="MathJax-Span-649"><span class="mi" id="MathJax-Span-650" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-651" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-652"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px;"><span style="position: absolute; clip: rect(3.36em 1000.47em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-653" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.416em;"><span class="mi" id="MathJax-Span-654" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-655" style="font-size: 70.7%; font-family: STIXGeneral;">−</span><span class="texatom" id="MathJax-Span-656"><span class="mrow" id="MathJax-Span-657"><span class="mo" id="MathJax-Span-658" style="font-size: 70.7%; font-family: STIXVariants;">|</span></span></span><span class="mi" id="MathJax-Span-659" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="texatom" id="MathJax-Span-660"><span class="mrow" id="MathJax-Span-661"><span class="mo" id="MathJax-Span-662" style="font-size: 70.7%; font-family: STIXVariants;">|</span></span></span><span class="mo" id="MathJax-Span-663" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(0.881em 1005.43em 1.242em -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 5.426em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span><span class="mo" id="MathJax-Span-664" style="font-family: STIXGeneral; padding-left: 0.261em;">+</span><span class="mfrac" id="MathJax-Span-665" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 5.426em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(3.153em 1001.86em 4.29em -999.997em); top: -4.646em; left: 50%; margin-left: -0.927em;"><span class="msubsup" id="MathJax-Span-666"><span style="display: inline-block; position: relative; width: 1.862em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.62em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-667" style="font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="texatom" id="MathJax-Span-668"><span class="mrow" id="MathJax-Span-669"><span class="mtext" id="MathJax-Span-670" style="font-size: 70.7%; font-family: STIXGeneral;">max</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(2.998em 1005.32em 4.186em -999.997em); top: -3.2em; left: 50%; margin-left: -2.632em;"><span class="mrow" id="MathJax-Span-671"><span class="mn" id="MathJax-Span-672" style="font-family: STIXGeneral;">1</span><span class="mo" id="MathJax-Span-673" style="font-family: STIXGeneral; padding-left: 0.261em;">+</span><span class="msubsup" id="MathJax-Span-674" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 3.618em; height: 0px;"><span style="position: absolute; clip: rect(3.36em 1000.42em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-675" style="font-family: STIXGeneral; font-style: italic;">e</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.285em; left: 0.467em;"><span class="texatom" id="MathJax-Span-676"><span class="mrow" id="MathJax-Span-677"><span class="msubsup" id="MathJax-Span-678"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px;"><span style="position: absolute; clip: rect(3.36em 1000.47em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-679" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.416em;"><span class="texatom" id="MathJax-Span-680"><span class="mrow" id="MathJax-Span-681"><span class="mi" id="MathJax-Span-682" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-683" style="font-size: 70.7%; font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-684"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px;"><span style="position: absolute; clip: rect(3.36em 1000.47em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-685" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.416em;"><span class="mi" id="MathJax-Span-686" style="font-size: 50%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-687" style="font-size: 70.7%; font-family: STIXGeneral;">−</span><span class="texatom" id="MathJax-Span-688"><span class="mrow" id="MathJax-Span-689"><span class="mo" id="MathJax-Span-690" style="font-size: 70.7%; font-family: STIXVariants;">|</span></span></span><span class="mi" id="MathJax-Span-691" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">y</span><span class="texatom" id="MathJax-Span-692"><span class="mrow" id="MathJax-Span-693"><span class="mo" id="MathJax-Span-694" style="font-size: 70.7%; font-family: STIXVariants;">|</span></span></span><span class="mo" id="MathJax-Span-695" style="font-size: 70.7%; font-family: STIXGeneral;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(0.881em 1005.43em 1.242em -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 5.426em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span><span class="mo" id="MathJax-Span-696" style="font-family: STIXGeneral;">.</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.059em; border-left: 0px solid; width: 0px; height: 2.753em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>V</mi><mrow class="MJX-TeXAtom-ORD"><mtext>box</mtext></mrow></msub><mo>=</mo><mfrac><msub><mi>T</mi><mrow class="MJX-TeXAtom-ORD"><mtext>max</mtext></mrow></msub><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>T</mi><mrow class="MJX-TeXAtom-ORD"><mi>β</mi></mrow></msub><mo stretchy="false">(</mo><msub><mi>T</mi><mi>r</mi></msub><mo>−</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo stretchy="false">)</mo></mrow></msup></mrow></mfrac><mo>+</mo><mfrac><msub><mi>T</mi><mrow class="MJX-TeXAtom-ORD"><mtext>max</mtext></mrow></msub><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>T</mi><mrow class="MJX-TeXAtom-ORD"><mi>β</mi></mrow></msub><mo stretchy="false">(</mo><msub><mi>T</mi><mi>r</mi></msub><mo>−</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo stretchy="false">)</mo></mrow></msup></mrow></mfrac><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-55">V_{\text{box}} = \frac{T_{\text{max}}}{1+e^{T_{\beta}(T_r-|x|)}} + \frac{T_{\text{max}}}{1+e^{T_{\beta}(T_r-|y|)}}.</script>
So that the shape of the trap boundary is a box,
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-56-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;trap&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;{&lt;/mo&gt;&lt;mtable columnalign=&quot;left left&quot; rowspacing=&quot;.2em&quot; columnspacing=&quot;1em&quot; displaystyle=&quot;false&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;max&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow&gt;&lt;mtext&gt;if&amp;#xA0;&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;box&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;max&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;box&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mtext&gt;otherwise,&lt;/mtext&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo fence=&quot;true&quot; stretchy=&quot;true&quot; symmetric=&quot;true&quot;&gt;&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-697" style="width: 16.015em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.226em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(2.275em 1013.23em 4.806em -999.997em); top: -3.768em; left: 0em;"><span class="mrow" id="MathJax-Span-698"><span class="msubsup" id="MathJax-Span-699"><span style="display: inline-block; position: relative; width: 1.81em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.67em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-700" style="font-family: STIXGeneral; font-style: italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.622em;"><span class="texatom" id="MathJax-Span-701"><span class="mrow" id="MathJax-Span-702"><span class="mtext" id="MathJax-Span-703" style="font-size: 70.7%; font-family: STIXGeneral;">trap</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-704" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="mrow" id="MathJax-Span-705" style="padding-left: 0.313em;"><span class="mo" id="MathJax-Span-706" style="vertical-align: -0.462em;"><span><span style="font-size: 111%; font-family: STIXSizeTwoSym;">{</span></span></span><span class="mtable" id="MathJax-Span-707" style="padding-right: 0.158em; padding-left: 0.158em;"><span style="display: inline-block; position: relative; width: 8.99em; height: 0px;"><span style="position: absolute; clip: rect(2.585em 1002.07em 4.961em -999.997em); top: -3.975em; left: 0em;"><span style="display: inline-block; position: relative; width: 2.12em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1002.07em 4.29em -999.997em); top: -4.543em; left: 0em;"><span class="mtd" id="MathJax-Span-708"><span class="mrow" id="MathJax-Span-709"><span class="msubsup" id="MathJax-Span-710"><span style="display: inline-block; position: relative; width: 1.862em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.62em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-711" style="font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="texatom" id="MathJax-Span-712"><span class="mrow" id="MathJax-Span-713"><span class="mtext" id="MathJax-Span-714" style="font-size: 70.7%; font-family: STIXGeneral;">max</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-715" style="font-family: STIXGeneral;">,</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.153em 1001.97em 4.29em -999.997em); top: -3.303em; left: 0em;"><span class="mtd" id="MathJax-Span-733"><span class="mrow" id="MathJax-Span-734"><span class="msubsup" id="MathJax-Span-735"><span style="display: inline-block; position: relative; width: 1.759em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.67em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-736" style="font-family: STIXGeneral; font-style: italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.622em;"><span class="texatom" id="MathJax-Span-737"><span class="mrow" id="MathJax-Span-738"><span class="mtext" id="MathJax-Span-739" style="font-size: 70.7%; font-family: STIXGeneral;">box</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-740" style="font-family: STIXGeneral;">,</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(2.585em 1005.79em 4.961em -999.997em); top: -3.975em; left: 3.205em;"><span style="display: inline-block; position: relative; width: 5.788em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1005.79em 4.29em -999.997em); top: -4.543em; left: 0em;"><span class="mtd" id="MathJax-Span-716"><span class="mrow" id="MathJax-Span-717"><span class="mrow" id="MathJax-Span-718"><span class="mtext" id="MathJax-Span-719" style="font-family: STIXGeneral;">if&nbsp;</span><span class="texatom" id="MathJax-Span-720"><span class="mrow" id="MathJax-Span-721"><span class="msubsup" id="MathJax-Span-722"><span style="display: inline-block; position: relative; width: 1.759em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.67em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-723" style="font-family: STIXGeneral; font-style: italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.622em;"><span class="texatom" id="MathJax-Span-724"><span class="mrow" id="MathJax-Span-725"><span class="mtext" id="MathJax-Span-726" style="font-size: 70.7%; font-family: STIXGeneral;">box</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-727" style="font-family: STIXGeneral; padding-left: 0.313em;">&gt;</span><span class="msubsup" id="MathJax-Span-728" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.862em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.62em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-729" style="font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="texatom" id="MathJax-Span-730"><span class="mrow" id="MathJax-Span-731"><span class="mtext" id="MathJax-Span-732" style="font-size: 70.7%; font-family: STIXGeneral;">max</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.153em 1004.08em 4.29em -999.997em); top: -3.303em; left: 0em;"><span class="mtd" id="MathJax-Span-741"><span class="mrow" id="MathJax-Span-742"><span class="mtext" id="MathJax-Span-743" style="font-family: STIXGeneral;">otherwise,</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-744"></span></span></span><span style="display: inline-block; width: 0px; height: 3.773em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.122em; border-left: 0px solid; width: 0px; height: 2.816em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>V</mi><mrow class="MJX-TeXAtom-ORD"><mtext>trap</mtext></mrow></msub><mo>=</mo><mrow><mo>{</mo><mtable columnalign="left left" rowspacing=".2em" columnspacing="1em" displaystyle="false"><mtr><mtd><msub><mi>T</mi><mrow class="MJX-TeXAtom-ORD"><mtext>max</mtext></mrow></msub><mo>,</mo></mtd><mtd><mrow><mtext>if&nbsp;</mtext><mrow class="MJX-TeXAtom-ORD"><msub><mi>V</mi><mrow class="MJX-TeXAtom-ORD"><mtext>box</mtext></mrow></msub><mo>&gt;</mo><msub><mi>T</mi><mrow class="MJX-TeXAtom-ORD"><mtext>max</mtext></mrow></msub></mrow></mrow></mtd></mtr><mtr><mtd><msub><mi>V</mi><mrow class="MJX-TeXAtom-ORD"><mtext>box</mtext></mrow></msub><mo>,</mo></mtd><mtd><mtext>otherwise,</mtext></mtd></mtr></mtable><mo fence="true" stretchy="true" symmetric="true"></mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-56">V_{\text{trap}} = \begin{cases}
T_{\text{max}},  & \text{if $V_{\text{box}}>T_{\text{max}}$}\cr
V_{\text{box}}, & \text{otherwise,}
\end{cases}</script>
where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-57-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;max&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-745" style="width: 2.275em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.862em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em 1001.86em 2.482em -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-746"><span class="msubsup" id="MathJax-Span-747"><span style="display: inline-block; position: relative; width: 1.862em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.62em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-748" style="font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="texatom" id="MathJax-Span-749"><span class="mrow" id="MathJax-Span-750"><span class="mtext" id="MathJax-Span-751" style="font-size: 70.7%; font-family: STIXGeneral;">max</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mrow class="MJX-TeXAtom-ORD"><mtext>max</mtext></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-57">T_{\text{max}}</script> (<code>TRAPHEIGHT</code>) is the maximum value of the trapping potential, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-58-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-752" style="width: 1.139em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em 1000.93em 2.482em -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-753"><span class="msubsup" id="MathJax-Span-754"><span style="display: inline-block; position: relative; width: 0.932em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.62em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-755" style="font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="mi" id="MathJax-Span-756" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mi>r</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-58">T_r</script> (<code>TRAPR</code>) is the radius of the bounding circle, and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-59-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;&amp;#x03B2;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-757" style="width: 1.191em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em 1000.98em 2.637em -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-758"><span class="msubsup" id="MathJax-Span-759"><span style="display: inline-block; position: relative; width: 0.984em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.62em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-760" style="font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="texatom" id="MathJax-Span-761"><span class="mrow" id="MathJax-Span-762"><span class="mi" id="MathJax-Span-763" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">β<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mrow class="MJX-TeXAtom-ORD"><mi>β</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-59">T_{\beta}</script> (<code>TRAPBETA</code>) controls the steepness of the soft wall.</p>
<h3>
<a id="user-content-the-shin-experiment" class="anchor" href="file:///tmp/14.html#the-shin-experiment" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>The Shin Experiment</h3>
<p>An optional mode can be enabled emulating an experiment where an oblate BEC was dragged around a stationary laser obstacle by translating the trap.
The simulation starts with a stationary trap. The velocity of the trap is increased to its maximum, and finally is slowed down back to stationary after a fixed period of time.</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>doShin</code></td>
<td>Set to <code>.true.</code> to enable the Shin experiment.</td>
</tr>
<tr>
<td><code>TVXDASH</code></td>
<td>Trap's maximum velocity in the <em>x</em> direction.</td>
</tr>
<tr>
<td><code>TVYDASH</code></td>
<td>Trap's maximum velocity in the <em>y</em> direction.</td>
</tr>
<tr>
<td><code>TTM</code></td>
<td>Amount of time the trap will be moving.</td>
</tr>
</tbody>
</table>
<h2>
<a id="user-content-object-potential-v_textobj" class="anchor" href="file:///tmp/14.html#object-potential-v_textobj" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Object Potential <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-60-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;obj&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-764" style="width: 1.906em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.579em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.46em 1001.58em 2.591em -999.999em); top: -2.201em; left: 0em;"><span class="mrow" id="MathJax-Span-765"><span class="msubsup" id="MathJax-Span-766"><span style="display: inline-block; position: relative; width: 1.579em; height: 0px;"><span style="position: absolute; clip: rect(3.246em 1000.69em 4.109em -999.999em); top: -3.987em; left: 0em;"><span class="mi" id="MathJax-Span-767" style="font-family: STIXGeneral; font-style: italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.091em;"></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span><span style="position: absolute; top: -3.838em; left: 0.626em;"><span class="texatom" id="MathJax-Span-768"><span class="mrow" id="MathJax-Span-769"><span class="mtext" id="MathJax-Span-770" style="font-size: 70.7%; font-family: STIXGeneral;">obj</span></span></span><span style="display: inline-block; width: 0px; height: 3.99em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.204em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.391em; border-left: 0px solid; width: 0px; height: 1.216em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>V</mi><mrow class="MJX-TeXAtom-ORD"><mtext>obj</mtext></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-60">V_{\text{obj}}</script></h2>
<p>To enable an object potential, set <code>enablePot=.true.</code> in <code>params.in</code>. The type of trapping potential is chosen by setting the <code>potType</code> variable.</p>
<h3>
<a id="user-content-gaussian-object" class="anchor" href="file:///tmp/14.html#gaussian-object" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Gaussian Object</h3>
<p><code>potType=0</code> enables a Gaussian Obstacle of the form
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-61-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;obj&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;max&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi&gt;exp&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;msubsup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/mfrac&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;msubsup&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/mfrac&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-771" style="width: 20.354em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.79em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(2.43em 1016.74em 5.323em -999.997em); top: -4.078em; left: 0em;"><span class="mrow" id="MathJax-Span-772"><span class="msubsup" id="MathJax-Span-773"><span style="display: inline-block; position: relative; width: 1.604em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.67em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-774" style="font-family: STIXGeneral; font-style: italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.622em;"><span class="texatom" id="MathJax-Span-775"><span class="mrow" id="MathJax-Span-776"><span class="mtext" id="MathJax-Span-777" style="font-size: 70.7%; font-family: STIXGeneral;">obj</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-778" style="font-family: STIXGeneral; padding-left: 0.313em;">=</span><span class="msubsup" id="MathJax-Span-779" style="padding-left: 0.313em;"><span style="display: inline-block; position: relative; width: 1.914em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.67em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-780" style="font-family: STIXGeneral; font-style: italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.622em;"><span class="texatom" id="MathJax-Span-781"><span class="mrow" id="MathJax-Span-782"><span class="mtext" id="MathJax-Span-783" style="font-size: 70.7%; font-family: STIXGeneral;">max</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mi" id="MathJax-Span-784" style="font-family: STIXGeneral; padding-left: 0.209em;">exp</span><span class="mo" id="MathJax-Span-785"></span><span class="mrow" id="MathJax-Span-786"><span class="mo" id="MathJax-Span-787" style="vertical-align: -0.566em;"><span style="font-family: STIXSizeThreeSym;">[</span></span><span class="mrow" id="MathJax-Span-788"><span class="mfrac" id="MathJax-Span-789"><span style="display: inline-block; position: relative; width: 3.722em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(2.998em 1003.62em 4.29em -999.997em); top: -4.646em; left: 50%; margin-left: -1.805em;"><span class="mrow" id="MathJax-Span-790"><span class="mo" id="MathJax-Span-791" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-792" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-793" style="font-family: STIXGeneral; padding-left: 0.261em;">−</span><span class="msubsup" id="MathJax-Span-794" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em 1000.47em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-795" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mn" id="MathJax-Span-796" style="font-size: 70.7%; font-family: STIXGeneral;">0</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-797"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.31em 4.29em -999.997em); top: -3.975em; left: 0em;"><span class="mo" id="MathJax-Span-798" style="font-family: STIXGeneral;">)</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.336em; left: 0.313em;"><span class="mn" id="MathJax-Span-799" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(2.998em 1000.88em 4.29em -999.997em); top: -3.2em; left: 50%; margin-left: -0.462em;"><span class="msubsup" id="MathJax-Span-800"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em 1000.42em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-801" style="font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.36em 1000.42em 4.135em -999.997em); top: -4.336em; left: 0.467em;"><span class="mn" id="MathJax-Span-802" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.515em 1000.42em 4.135em -999.997em); top: -3.82em; left: 0.416em;"><span class="mi" id="MathJax-Span-803" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(0.881em 1003.72em 1.242em -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.722em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span><span class="mo" id="MathJax-Span-804" style="font-family: STIXGeneral; padding-left: 0.261em;">+</span><span class="mfrac" id="MathJax-Span-805" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 3.722em; height: 0px; margin-right: 0.106em; margin-left: 0.106em;"><span style="position: absolute; clip: rect(2.998em 1003.62em 4.341em -999.997em); top: -4.646em; left: 50%; margin-left: -1.805em;"><span class="mrow" id="MathJax-Span-806"><span class="mo" id="MathJax-Span-807" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-808" style="font-family: STIXGeneral; font-style: italic;">y</span><span class="mo" id="MathJax-Span-809" style="font-family: STIXGeneral; padding-left: 0.261em;">−</span><span class="msubsup" id="MathJax-Span-810" style="padding-left: 0.261em;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em 1000.42em 4.341em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-811" style="font-family: STIXGeneral; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mn" id="MathJax-Span-812" style="font-size: 70.7%; font-family: STIXGeneral;">0</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-813"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.31em 4.29em -999.997em); top: -3.975em; left: 0em;"><span class="mo" id="MathJax-Span-814" style="font-family: STIXGeneral;">)</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -4.336em; left: 0.313em;"><span class="mn" id="MathJax-Span-815" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(2.998em 1000.88em 4.445em -999.997em); top: -3.2em; left: 50%; margin-left: -0.462em;"><span class="msubsup" id="MathJax-Span-816"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em 1000.42em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-817" style="font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.36em 1000.42em 4.135em -999.997em); top: -4.336em; left: 0.467em;"><span class="mn" id="MathJax-Span-818" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(3.515em 1000.42em 4.29em -999.997em); top: -3.82em; left: 0.416em;"><span class="mi" id="MathJax-Span-819" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; clip: rect(0.881em 1003.72em 1.242em -999.997em); top: -1.289em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 3.722em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.087em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-820" style="vertical-align: -0.566em;"><span style="font-family: STIXSizeThreeSym;">]</span></span></span><span class="mo" id="MathJax-Span-821" style="font-family: STIXGeneral;">,</span></span><span style="display: inline-block; width: 0px; height: 4.083em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.372em; border-left: 0px solid; width: 0px; height: 3.253em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>V</mi><mrow class="MJX-TeXAtom-ORD"><mtext>obj</mtext></mrow></msub><mo>=</mo><msub><mi>V</mi><mrow class="MJX-TeXAtom-ORD"><mtext>max</mtext></mrow></msub><mi>exp</mi><mo>⁡</mo><mrow><mo>[</mo><mrow><mfrac><mrow><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><msub><mi>x</mi><mn>0</mn></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><msubsup><mi>r</mi><mi>x</mi><mn>2</mn></msubsup></mfrac><mo>+</mo><mfrac><mrow><mo stretchy="false">(</mo><mi>y</mi><mo>−</mo><msub><mi>y</mi><mn>0</mn></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><msubsup><mi>r</mi><mi>y</mi><mn>2</mn></msubsup></mfrac></mrow><mo>]</mo></mrow><mo>,</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-61">V_{\text{obj}} = V_{\text{max}} \exp \left[ \frac{(x-x_0)^2}{r_x^2} + \frac{(y-y_0)^2}{r_y^2} \right],</script>
where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-62-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-822" style="width: 0.932em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.552em 1000.78em 2.482em -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-823"><span class="msubsup" id="MathJax-Span-824"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em 1000.42em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-825" style="font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.416em;"><span class="mi" id="MathJax-Span-826" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>r</mi><mi>x</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-62">r_x</script> (<code>RRX</code>) and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-63-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-827" style="width: 0.932em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.552em 1000.78em 2.637em -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-828"><span class="msubsup" id="MathJax-Span-829"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em 1000.42em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-830" style="font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.416em;"><span class="mi" id="MathJax-Span-831" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>r</mi><mi>y</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-63">r_y</script> (<code>RRY</code>) are the obstacle radius along the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-64-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-832" style="width: 0.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.862em 1000.47em 2.637em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-833"><span class="mi" id="MathJax-Span-834" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-64">x</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-65-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-835" style="width: 0.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.862em 1000.47em 2.843em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-836"><span class="mi" id="MathJax-Span-837" style="font-family: STIXGeneral; font-style: italic;">y</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-65">y</script> directions and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-66-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-838" style="width: 3.515em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.895em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.655em 1002.84em 2.843em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-839"><span class="mo" id="MathJax-Span-840" style="font-family: STIXGeneral;">(</span><span class="msubsup" id="MathJax-Span-841"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em 1000.47em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-842" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mn" id="MathJax-Span-843" style="font-size: 70.7%; font-family: STIXGeneral;">0</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-844" style="font-family: STIXGeneral;">,</span><span class="msubsup" id="MathJax-Span-845" style="padding-left: 0.209em;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em 1000.42em 4.341em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-846" style="font-family: STIXGeneral; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mn" id="MathJax-Span-847" style="font-size: 70.7%; font-family: STIXGeneral;">0</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span><span class="mo" id="MathJax-Span-848" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo>,</mo><msub><mi>y</mi><mn>0</mn></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-66">(x_0,y_0)</script> (<code>OBJXDASH</code>, <code>OBJYDASH</code>) is the obstacle position. <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-67-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;max&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-849" style="width: 2.327em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.914em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em 1001.91em 2.482em -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-850"><span class="msubsup" id="MathJax-Span-851"><span style="display: inline-block; position: relative; width: 1.914em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.67em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-852" style="font-family: STIXGeneral; font-style: italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.622em;"><span class="texatom" id="MathJax-Span-853"><span class="mrow" id="MathJax-Span-854"><span class="mtext" id="MathJax-Span-855" style="font-size: 70.7%; font-family: STIXGeneral;">max</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>V</mi><mrow class="MJX-TeXAtom-ORD"><mtext>max</mtext></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-67">V_{\text{max}}</script> (<code>OBJHEIGHT</code>) is the maximum height of the potential.</p>
<h4>
<a id="user-content-oscillation" class="anchor" href="file:///tmp/14.html#oscillation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Oscillation</h4>
<p>The Gaussian obstacle can forced to oscillate, emulating wires or tuning forks as used in liquid helium experiments. The oscillation is achieved by a coordinate transform for the obstacle only of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-68-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mi&gt;sin&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-856" style="width: 8.784em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.234em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.655em 1007.18em 2.792em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-857"><span class="mi" id="MathJax-Span-858" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-859" style="font-family: STIXGeneral; padding-left: 0.313em;">→</span><span class="mi" id="MathJax-Span-860" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.313em;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-861" style="font-family: STIXGeneral; padding-left: 0.261em;">+</span><span class="mi" id="MathJax-Span-862" style="font-family: STIXGeneral; font-style: italic; padding-left: 0.261em;">A</span><span class="mi" id="MathJax-Span-863" style="font-family: STIXGeneral; padding-left: 0.209em;">sin</span><span class="mo" id="MathJax-Span-864"></span><span class="mo" id="MathJax-Span-865" style="font-family: STIXGeneral;">(</span><span class="mi" id="MathJax-Span-866" style="font-family: STIXGeneral; font-style: italic;">ω</span><span class="mi" id="MathJax-Span-867" style="font-family: STIXGeneral; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-868" style="font-family: STIXGeneral;">)</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo stretchy="false">→</mo><mi>x</mi><mo>+</mo><mi>A</mi><mi>sin</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>ω</mi><mi>t</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-68">x\rightarrow x+A\sin(\omega t)</script>, where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-69-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-869" style="width: 0.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.655em 1000.57em 2.637em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-870"><span class="mi" id="MathJax-Span-871" style="font-family: STIXGeneral; font-style: italic;">A</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math></span></span><script type="math/tex" id="MathJax-Element-69">A</script> (<code>OBJAMP</code>) is the oscillation amplitude and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-70-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-872" style="width: 0.829em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.914em 1000.62em 2.637em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-873"><span class="mi" id="MathJax-Span-874" style="font-family: STIXGeneral; font-style: italic;">ω</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ω</mi></math></span></span><script type="math/tex" id="MathJax-Element-70">\omega</script> (<code>OBJW</code>) the frequency.</p>
<h4>
<a id="user-content-rotating" class="anchor" href="file:///tmp/14.html#rotating" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Rotating</h4>
<p><code>potType=1</code> enables a rotating Gaussian obstacle. The obstacle can rotate freely about its centre, and reacts to forces and pressures exerted by the fluid.  Here the obstacle has an initial angle (<code>OBJANGLE</code>), initial angular velocity (<code>OBJANGLEV</code>) and a <a href="http://en.wikipedia.org/wiki/Moment_of_inertia" rel="nofollow">moment of inertia</a> (<code>MOMINERTIA</code>).</p>
<h3>
<a id="user-content-bitmap-sourced-potential" class="anchor" href="file:///tmp/14.html#bitmap-sourced-potential" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Bitmap Sourced Potential</h3>
<p><code>potType=4</code> enables the loading of a bitmap image which is then used to define a potential. To use this feature first create a grayscale bitmap of size (<code>NX+1</code> <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-71-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-875" style="width: 0.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.81em 1000.57em 2.637em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-876"><span class="mo" id="MathJax-Span-877" style="font-family: STIXGeneral;">×</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>×</mo></math></span></span><script type="math/tex" id="MathJax-Element-71">\times</script> <code>NY+1</code>). White areas correspond to areas where the potential will be equal to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-72-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;max&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-878" style="width: 2.327em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.914em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em 1001.91em 2.482em -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-879"><span class="msubsup" id="MathJax-Span-880"><span style="display: inline-block; position: relative; width: 1.914em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.67em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-881" style="font-family: STIXGeneral; font-style: italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.622em;"><span class="texatom" id="MathJax-Span-882"><span class="mrow" id="MathJax-Span-883"><span class="mtext" id="MathJax-Span-884" style="font-size: 70.7%; font-family: STIXGeneral;">max</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>V</mi><mrow class="MJX-TeXAtom-ORD"><mtext>max</mtext></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-72">V_{\text{max}}</script> (<code>OBJHEIGHT</code>), while black areas correspond to areas where the potential will be 0. Grayscale colours will cause the potential to scale between 0 and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-73-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;max&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-885" style="width: 2.327em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.914em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em 1001.91em 2.482em -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-886"><span class="msubsup" id="MathJax-Span-887"><span style="display: inline-block; position: relative; width: 1.914em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.67em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-888" style="font-family: STIXGeneral; font-style: italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.622em;"><span class="texatom" id="MathJax-Span-889"><span class="mrow" id="MathJax-Span-890"><span class="mtext" id="MathJax-Span-891" style="font-size: 70.7%; font-family: STIXGeneral;">max</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>V</mi><mrow class="MJX-TeXAtom-ORD"><mtext>max</mtext></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-73">V_{\text{max}}</script>.</p>
<p>Set the parameter <code>pot_filename</code> equal to the location of the potential <code>.bmp</code> image.</p>
<h1>
<a id="user-content-output-data" class="anchor" href="file:///tmp/14.html#output-data" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Output Data</h1>
<p>Data is output every set amount of time steps. This output frequency can be easily customised. <code>dumpwf</code> sets the wavefunction output frequency and <code>dumputil</code> sets the utility output frequency.</p>
<h3>
<a id="user-content-wavefunction-output" class="anchor" href="file:///tmp/14.html#wavefunction-output" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Wavefunction Output</h3>
<p>Wavefunction files are output with the filename: <code>dumpwf.ssssss.nc</code>. Here <code>ssssss</code> is the number of the output file. e.g <code>dumpwf.000000.nc</code>.</p>
<p>These files are formatted as NetCDF files and contains the following data:</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Size</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>x</code></td>
<td><code>NX+1</code></td>
<td>Grid points along the x dimension</td>
</tr>
<tr>
<td><code>y</code></td>
<td><code>NY+1</code></td>
<td>Grid points along the y dimension</td>
</tr>
<tr>
<td><code>real</code></td>
<td>(<code>NX+1</code> <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-74-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-892" style="width: 0.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.81em 1000.57em 2.637em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-893"><span class="mo" id="MathJax-Span-894" style="font-family: STIXGeneral;">×</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>×</mo></math></span></span><script type="math/tex" id="MathJax-Element-74">\times</script> <code>NY+1</code>)</td>
<td>Real part of the system wavefunction</td>
</tr>
<tr>
<td><code>imag</code></td>
<td>(<code>NX+1</code> <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-75-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-895" style="width: 0.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.81em 1000.57em 2.637em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-896"><span class="mo" id="MathJax-Span-897" style="font-family: STIXGeneral;">×</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>×</mo></math></span></span><script type="math/tex" id="MathJax-Element-75">\times</script> <code>NY+1</code>)</td>
<td>Imaginary part of the system wavefunction</td>
</tr>
<tr>
<td><code>pot</code></td>
<td>(<code>NX+1</code> <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-76-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-898" style="width: 0.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.81em 1000.57em 2.637em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-899"><span class="mo" id="MathJax-Span-900" style="font-family: STIXGeneral;">×</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>×</mo></math></span></span><script type="math/tex" id="MathJax-Element-76">\times</script> <code>NY+1</code>)</td>
<td>The current external potential field.</td>
</tr>
</tbody>
</table>
<h4>
<a id="user-content-reading-wavefunction-output" class="anchor" href="file:///tmp/14.html#reading-wavefunction-output" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Reading Wavefunction Output</h4>
<p>Included in the <code>scripts</code> folder is a matlab script named <code>gpeget2dPSI.m</code>. Use this file to load the output wavefunction data into matlab for post processing. The function takes the simulation directory and the number of the data file.</p>
<pre><code>[gridx,gridy,psi,potential] = gpeget2dPSI('/directory/to/simulation',250);
</code></pre>
<h3>
<a id="user-content-utility-output" class="anchor" href="file:///tmp/14.html#utility-output" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Utility Output</h3>
<p>The energy and norm are calculated and output by default every 100 time steps as diagnostic check as the simulation is running. 2D-GP will create a file at the start of the simulation named <code>utils.dat</code>, and continuously write to the file with:</p>
<table>
<thead>
<tr>
<th>Column 1</th>
<th>Column 2</th>
<th>Column 3</th>
<th>Column 4</th>
</tr>
</thead>
<tbody>
<tr>
<td><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-77-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-901" style="width: 1.501em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.655em 1001.24em 2.792em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-902"><span class="mo" id="MathJax-Span-903" style="font-family: STIXGeneral;">−</span><span class="mi" id="MathJax-Span-904" style="font-family: STIXGeneral; font-style: italic;">i</span><span class="mi" id="MathJax-Span-905" style="font-family: STIXGeneral; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>−</mo><mi>i</mi><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-77">-it</script>, imaginary time</td>
<td><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-78-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-906" style="width: 0.313em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.261em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.759em 1000.26em 2.637em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-907"><span class="mi" id="MathJax-Span-908" style="font-family: STIXGeneral; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-78">t</script>, simulation time</td>
<td><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-79-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-909" style="width: 0.777em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.622em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.655em 1000.62em 2.637em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-910"><span class="mi" id="MathJax-Span-911" style="font-family: STIXGeneral; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>E</mi></math></span></span><script type="math/tex" id="MathJax-Element-79">E</script>, the total energy at time <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-80-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-912" style="width: 0.313em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.261em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.759em 1000.26em 2.637em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-913"><span class="mi" id="MathJax-Span-914" style="font-family: STIXGeneral; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-80">t</script></td>
<td><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-81-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-915" style="width: 0.881em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.655em 1000.73em 2.637em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-916"><span class="mi" id="MathJax-Span-917" style="font-family: STIXGeneral; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-81">N</script>, the norm at time <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-82-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-918" style="width: 0.313em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.261em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.759em 1000.26em 2.637em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-919"><span class="mi" id="MathJax-Span-920" style="font-family: STIXGeneral; font-style: italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-82">t</script></td>
</tr>
</tbody>
</table>
<h1>
<a id="user-content-example-paramsin" class="anchor" href="file:///tmp/14.html#example-paramsin" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Example <code>params.in</code>
</h1>
<p>An example (and default) <code>params.in</code> is provided by 2D-GP. It sets up a trapped BEC system and and looks like this:</p>
<pre><code>!Enter custom parameters in the form
!PARAMETER_NAME = VALUE
!
NX = 256
NY = 256
NSTEPS=5000
DSTEPS=1000
ISTEPS=100

GAMMAC = 0.1d0
DSPACE = 0.1d0
DTSIZE = 0.002d0

RHSType = 1
BCX = 1
BCY = 1
harm_osc_C = 2000.0d0
harm_osc_mu = 25.26698674d0

enableTrap = .true.
trapType = 0
</code></pre>
<h2>
<a id="user-content-list-of-parameters" class="anchor" href="file:///tmp/14.html#list-of-parameters" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>List of Parameters</h2>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Default, if omitted</th>
<th>Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>NSTEPS</code></td>
<td><code>1000</code></td>
<td>Number of iterations to run the solver in real time.</td>
</tr>
<tr>
<td><code>ISTEPS</code></td>
<td><code>0</code></td>
<td>Number of iterations to run the solver in imaginary time.</td>
</tr>
<tr>
<td><code>DSTEPS</code></td>
<td><code>0</code></td>
<td>Number of iterations to run the solver highly damped.</td>
</tr>
<tr>
<td><code>HOLDIC</code></td>
<td><code>.true.</code></td>
<td>If true, the phase defined in <code>ic.in</code> is constantly re-imprinted during <code>ISTEPS</code> and <code>DSTEPS</code>.</td>
</tr>
<tr>
<td><code>PLOTALL</code></td>
<td><code>.false.</code></td>
<td>If true, wavefunction files are written during <code>ISTEPS</code> and <code>DSTEPS</code>.</td>
</tr>
<tr>
<td><code>NX</code></td>
<td><code>512</code></td>
<td>Number of grid points in the x direction, not including an extra grid point for zero.</td>
</tr>
<tr>
<td><code>NY</code></td>
<td><code>512</code></td>
<td>Number of grid points in the y direction, not including an extra grid point for zero.</td>
</tr>
<tr>
<td><code>DSPACE</code></td>
<td><code>0.1</code></td>
<td>Grid spacing in dimensionless units</td>
</tr>
<tr>
<td><code>DTSIZE</code></td>
<td><code>0.002</code></td>
<td>Time step size in dimensionless units</td>
</tr>
<tr>
<td><code>dumpwf</code></td>
<td><code>100</code></td>
<td>Wavefunction output frequency</td>
</tr>
<tr>
<td><code>dumputil</code></td>
<td><code>100</code></td>
<td>Force/energy output frequency</td>
</tr>
<tr>
<td><code>RHSType</code></td>
<td><code>1</code></td>
<td>GPE Type - <code>0</code> for <strong>natural units</strong>, <code>1</code> for <strong>harmonic oscillator units</strong>.</td>
</tr>
<tr>
<td><code>harm_osc_C</code></td>
<td><code>2000</code></td>
<td>Value of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-83-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-921" style="width: 1.759em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.552em 1001.45em 2.534em -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-922"><span class="msubsup" id="MathJax-Span-923"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; clip: rect(3.36em 1000.47em 4.341em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-924" style="font-family: STIXGeneral; font-style: italic;">g</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="texatom" id="MathJax-Span-925"><span class="mrow" id="MathJax-Span-926"><span class="mn" id="MathJax-Span-927" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span class="mi" id="MathJax-Span-928" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">D</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn><mi>D</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-83">g_{2D}</script>.</td>
</tr>
<tr>
<td><code>harm_osc_mu</code></td>
<td><code>25.267</code></td>
<td>Value of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-84-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;&amp;#x03BC;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-929" style="width: 1.759em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.604em 1001.45em 2.534em -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-930"><span class="msubsup" id="MathJax-Span-931"><span style="display: inline-block; position: relative; width: 1.449em; height: 0px;"><span style="position: absolute; clip: rect(3.412em 1000.47em 4.341em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-932" style="font-family: STIXGeneral; font-style: italic;">μ</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.519em;"><span class="texatom" id="MathJax-Span-933"><span class="mrow" id="MathJax-Span-934"><span class="mn" id="MathJax-Span-935" style="font-size: 70.7%; font-family: STIXGeneral;">2</span><span class="mi" id="MathJax-Span-936" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">D</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>μ</mi><mrow class="MJX-TeXAtom-ORD"><mn>2</mn><mi>D</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-84">\mu_{2D}</script>.</td>
</tr>
<tr>
<td><code>GAMMAC</code></td>
<td><code>0</code></td>
<td>Value of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-85-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B3;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-937" style="width: 0.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.914em 1000.47em 2.843em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-938"><span class="mi" id="MathJax-Span-939" style="font-family: STIXGeneral; font-style: italic;">γ<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>γ</mi></math></span></span><script type="math/tex" id="MathJax-Element-85">\gamma</script>.</td>
</tr>
<tr>
<td><code>NORMALL</code></td>
<td><code>.false</code></td>
<td>If true, the GPE is renormalised every time step.</td>
</tr>
<tr>
<td><code>BCX</code></td>
<td><code>0</code></td>
<td>Boundary conditions in the x direction.</td>
</tr>
<tr>
<td><code>BCY</code></td>
<td><code>0</code></td>
<td>Boundary conditions in the y direction.</td>
</tr>
<tr>
<td><code>noiseamp</code></td>
<td><code>0</code></td>
<td>Amplitude of random noise to add to the initial condition.</td>
</tr>
<tr>
<td><code>ROM</code></td>
<td><code>0</code></td>
<td>Angular momentum of the rotating frame, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-86-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x03A9;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-940" style="width: 0.881em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.726em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.655em 1000.67em 2.637em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-941"><span class="mi" id="MathJax-Span-942" style="font-family: STIXGeneral;">Ω</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal">Ω</mi></math></span></span><script type="math/tex" id="MathJax-Element-86">\Omega</script></td>
</tr>
<tr>
<td><code>VOB</code></td>
<td><code>0</code></td>
<td>Velocity of the linearly translating frame, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-87-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;v&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-943" style="width: 1.501em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.552em 1001.24em 2.482em -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-944"><span class="msubsup" id="MathJax-Span-945"><span style="display: inline-block; position: relative; width: 1.242em; height: 0px;"><span style="position: absolute; clip: rect(3.36em 1000.42em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-946" style="font-family: STIXGeneral; font-style: italic;">v</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="texatom" id="MathJax-Span-947"><span class="mrow" id="MathJax-Span-948"><span class="mi" id="MathJax-Span-949" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">o</span><span class="mi" id="MathJax-Span-950" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">b</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>v</mi><mrow class="MJX-TeXAtom-ORD"><mi>o</mi><mi>b</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-87">v_{ob}</script></td>
</tr>
<tr>
<td><code>enablePot</code></td>
<td><code>.true.</code></td>
<td>Enable the potential obstacle.</td>
</tr>
<tr>
<td><code>potType</code></td>
<td><code>-1</code></td>
<td>Obstacle type.</td>
</tr>
<tr>
<td><code>RRX</code></td>
<td><code>2.0</code></td>
<td>Value for <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-88-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-951" style="width: 0.932em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.552em 1000.78em 2.482em -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-952"><span class="msubsup" id="MathJax-Span-953"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em 1000.42em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-954" style="font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.416em;"><span class="mi" id="MathJax-Span-955" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>r</mi><mi>x</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-88">r_x</script>, obstacle radius in the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-89-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-956" style="width: 0.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.862em 1000.47em 2.637em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-957"><span class="mi" id="MathJax-Span-958" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-89">x</script> direction.</td>
</tr>
<tr>
<td><code>RRY</code></td>
<td><code>2.0</code></td>
<td>Value for <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-90-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-959" style="width: 0.932em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.552em 1000.78em 2.637em -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-960"><span class="msubsup" id="MathJax-Span-961"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.36em 1000.42em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-962" style="font-family: STIXGeneral; font-style: italic;">r<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.416em;"><span class="mi" id="MathJax-Span-963" style="font-size: 70.7%; font-family: STIXGeneral; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>r</mi><mi>y</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-90">r_y</script>, obstacle radius in the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-91-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-964" style="width: 0.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.862em 1000.47em 2.843em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-965"><span class="mi" id="MathJax-Span-966" style="font-family: STIXGeneral; font-style: italic;">y</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-91">y</script> direction.</td>
</tr>
<tr>
<td><code>OBJHEIGHT</code></td>
<td><code>50</code></td>
<td>Value for <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-92-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;max&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-967" style="width: 2.327em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.914em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em 1001.91em 2.482em -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-968"><span class="msubsup" id="MathJax-Span-969"><span style="display: inline-block; position: relative; width: 1.914em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.67em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-970" style="font-family: STIXGeneral; font-style: italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.622em;"><span class="texatom" id="MathJax-Span-971"><span class="mrow" id="MathJax-Span-972"><span class="mtext" id="MathJax-Span-973" style="font-size: 70.7%; font-family: STIXGeneral;">max</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>V</mi><mrow class="MJX-TeXAtom-ORD"><mtext>max</mtext></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-92">V_{\text{max}}</script>, the maximum barrier height. A maximum height of 0 is equivalent to having no obstacle.</td>
</tr>
<tr>
<td><code>OBJXDASH</code></td>
<td><code>0</code></td>
<td>Value for <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-93-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-974" style="width: 1.087em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.552em 1000.88em 2.482em -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-975"><span class="msubsup" id="MathJax-Span-976"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em 1000.47em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-977" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mn" id="MathJax-Span-978" style="font-size: 70.7%; font-family: STIXGeneral;">0</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>x</mi><mn>0</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-93">x_0</script>, the obstacle's <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-94-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-979" style="width: 0.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.862em 1000.47em 2.637em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-980"><span class="mi" id="MathJax-Span-981" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-94">x</script> position.</td>
</tr>
<tr>
<td><code>OBJYDASH</code></td>
<td><code>0</code></td>
<td>Value for <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-95-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-982" style="width: 1.087em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.552em 1000.88em 2.534em -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-983"><span class="msubsup" id="MathJax-Span-984"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em 1000.42em 4.341em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-985" style="font-family: STIXGeneral; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mn" id="MathJax-Span-986" style="font-size: 70.7%; font-family: STIXGeneral;">0</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>y</mi><mn>0</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-95">y_0</script>, the obstacle's <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-96-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-987" style="width: 0.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.862em 1000.47em 2.843em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-988"><span class="mi" id="MathJax-Span-989" style="font-family: STIXGeneral; font-style: italic;">y</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-96">y</script> position.</td>
</tr>
<tr>
<td><code>OBJAMP</code></td>
<td><code>0</code></td>
<td>Oscillating obstacle's amplitude.</td>
</tr>
<tr>
<td><code>OBJW</code></td>
<td><code>0</code></td>
<td>Oscillating obstacle's frequency.</td>
</tr>
<tr>
<td><code>OBJANGLE</code></td>
<td><code>0.1</code></td>
<td>Initial obstacle angle for rotating obstacle.</td>
</tr>
<tr>
<td><code>OBJANGLEV</code></td>
<td><code>0.1</code></td>
<td>Initial angular velocity for rotating obstacle.</td>
</tr>
<tr>
<td><code>MOMINERTIA</code></td>
<td><code>0.000001</code></td>
<td>Rotating obstacle's <a href="http://en.wikipedia.org/wiki/Moment_of_inertia" rel="nofollow">Moment of Inertia</a>
</td>
</tr>
<tr>
<td><code>enableTrap</code></td>
<td><code>.true.</code></td>
<td>Enable the potential trap.</td>
</tr>
<tr>
<td><code>trapType</code></td>
<td><code>-1</code></td>
<td>Trap type.</td>
</tr>
<tr>
<td><code>TRAPHEIGHT</code></td>
<td><code>50</code></td>
<td>Value for <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-97-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;max&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-990" style="width: 2.275em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.862em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.346em 1001.86em 2.482em -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-991"><span class="msubsup" id="MathJax-Span-992"><span style="display: inline-block; position: relative; width: 1.862em; height: 0px;"><span style="position: absolute; clip: rect(3.153em 1000.62em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-993" style="font-family: STIXGeneral; font-style: italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.571em;"><span class="texatom" id="MathJax-Span-994"><span class="mrow" id="MathJax-Span-995"><span class="mtext" id="MathJax-Span-996" style="font-size: 70.7%; font-family: STIXGeneral;">max</span></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mrow class="MJX-TeXAtom-ORD"><mtext>max</mtext></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-97">T_{\text{max}}</script>, the maximum trap height. A maximum height of 0 is equivalent to having no trapping potential.</td>
</tr>
<tr>
<td><code>TXDASH</code></td>
<td><code>0</code></td>
<td>Value for <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-98-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-997" style="width: 1.087em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.552em 1000.88em 2.482em -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-998"><span class="msubsup" id="MathJax-Span-999"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em 1000.47em 4.135em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1000" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mn" id="MathJax-Span-1001" style="font-size: 70.7%; font-family: STIXGeneral;">0</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>x</mi><mn>0</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-98">x_0</script>, center of the trap in <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-99-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1002" style="width: 0.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.862em 1000.47em 2.637em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-1003"><span class="mi" id="MathJax-Span-1004" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-99">x</script>.</td>
</tr>
<tr>
<td><code>TYDASH</code></td>
<td><code>0</code></td>
<td>Value for <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-100-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1005" style="width: 1.087em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.552em 1000.88em 2.534em -999.997em); top: -2.167em; left: 0em;"><span class="mrow" id="MathJax-Span-1006"><span class="msubsup" id="MathJax-Span-1007"><span style="display: inline-block; position: relative; width: 0.881em; height: 0px;"><span style="position: absolute; clip: rect(3.36em 1000.42em 4.341em -999.997em); top: -3.975em; left: 0em;"><span class="mi" id="MathJax-Span-1008" style="font-family: STIXGeneral; font-style: italic;">y</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.467em;"><span class="mn" id="MathJax-Span-1009" style="font-size: 70.7%; font-family: STIXGeneral;">0</span><span style="display: inline-block; width: 0px; height: 3.98em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.172em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>y</mi><mn>0</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-100">y_0</script>, center of the trap in <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-101-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1010" style="width: 0.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.862em 1000.47em 2.843em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-1011"><span class="mi" id="MathJax-Span-1012" style="font-family: STIXGeneral; font-style: italic;">y</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-101">y</script>.</td>
</tr>
<tr>
<td><code>TXSCALE</code></td>
<td><code>1</code></td>
<td>A scaling factor for the trap in <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-102-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1013" style="width: 0.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.862em 1000.47em 2.637em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-1014"><span class="mi" id="MathJax-Span-1015" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-102">x</script>.</td>
</tr>
<tr>
<td><code>TYSCALE</code></td>
<td><code>1</code></td>
<td>A scaling factor for the trap in <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-103-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1016" style="width: 0.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.862em 1000.47em 2.843em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-1017"><span class="mi" id="MathJax-Span-1018" style="font-family: STIXGeneral; font-style: italic;">y</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-103">y</script>.</td>
</tr>
<tr>
<td><code>TRAPR</code></td>
<td><code>5</code></td>
<td>Box/Circle trap size.</td>
</tr>
<tr>
<td><code>TRAPBETA</code></td>
<td><code>2</code></td>
<td>Soft wall trap steepness.</td>
</tr>
<tr>
<td><code>potRep</code></td>
<td><code>.false.</code></td>
<td>If true, recalculates the potential term <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-104-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1019" style="width: 0.829em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.674em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.655em 1000.67em 2.637em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-1020"><span class="mi" id="MathJax-Span-1021" style="font-family: STIXGeneral; font-style: italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>V</mi></math></span></span><script type="math/tex" id="MathJax-Element-104">V</script> at every time step.</td>
</tr>
<tr>
<td><code>doShin</code></td>
<td><code>.false.</code></td>
<td>If true, runs a simulation of the Shin experiment.</td>
</tr>
<tr>
<td><code>TTM</code></td>
<td><code>0</code></td>
<td>Amount of time the trap will be moving in the Shin experiment.</td>
</tr>
<tr>
<td><code>TVXDASH</code></td>
<td><code>0</code></td>
<td>Trap's maximum velocity in the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-105-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1022" style="width: 0.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.862em 1000.47em 2.637em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-1023"><span class="mi" id="MathJax-Span-1024" style="font-family: STIXGeneral; font-style: italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-105">x</script> direction in the Shin experiment.</td>
</tr>
<tr>
<td><code>TVYDASH</code></td>
<td><code>0</code></td>
<td>Trap's maximum velocity in the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-106-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1025" style="width: 0.571em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.467em; height: 0px; font-size: 121%;"><span style="position: absolute; clip: rect(1.862em 1000.47em 2.843em -999.997em); top: -2.477em; left: 0em;"><span class="mrow" id="MathJax-Span-1026"><span class="mi" id="MathJax-Span-1027" style="font-family: STIXGeneral; font-style: italic;">y</span></span><span style="display: inline-block; width: 0px; height: 2.482em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-106">y</script> direction in the Shin experiment.</td>
</tr>
<tr>
<td><code>pot_filename</code></td>
<td>''</td>
<td>Filename for bitmap sourced potential.</td>
</tr>
</tbody>
</table>
<h1>
<a id="user-content-todo-vortex-killing-and-damped-region" class="anchor" href="file:///tmp/14.html#todo-vortex-killing-and-damped-region" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>TODO: Vortex Killing and damped region</h1>
<pre><code>  !Vortex Killer
  logical :: doVortexKilling = .false.
  logical :: vortexKillX = .true.
  logical :: vortexKillY = .false.
  double precision :: vortexKillXDist = 40.0d0
  double precision :: vortexKillYDist = 0.0d0
  integer :: vortexKillFreq = huge(100)
  integer :: killgamma = 0
  !Damping radius
  logical :: dampedX = .false.
  logical :: dampedY = .false.
  logical :: dampedR = .false.
  double precision :: dampedXDist = 10.0d0
  double precision :: dampedYDist = 0.0d0
  double precision :: dampedRDist = 0.0d0
  double precision :: dampedRWidth = 10.0d0
  double precision :: dampedGamma = 0.0d0
</code></pre>
</article><script async="">document.write('<script src="http://' + (location.host || 'localhost').split(':')[0] + ':35729/livereload.js?snipver=1"></' + 'script>')</script><script src="./README_files/livereload.js"></script><div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: STIXSizeOneSym, sans-serif;"></div></div></body></html>